
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://guillp.github.io/jwskate/">
      
      
      
        <link rel="next" href="installation/">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.6">
    
    
      
        <title>jwskate</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="jwskate" class="md-header__button md-logo" aria-label="jwskate" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            jwskate
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              home
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/guillp/jwskate" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jwskate
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="." class="md-tabs__link">
        
  
    
  
  home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="installation/" class="md-tabs__link">
        
  
    
  
  installation

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="usage/" class="md-tabs__link">
        
  
    
  
  usage

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="recipes/" class="md-tabs__link">
        
  
    
  
  examples

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="api/" class="md-tabs__link">
        
  
    
  
  API

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="contributing/" class="md-tabs__link">
        
  
    
  
  contributing

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="jwskate" class="md-nav__button md-logo" aria-label="jwskate" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    jwskate
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/guillp/jwskate" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jwskate
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    home
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    home
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#features" class="md-nav__link">
    <span class="md-ellipsis">
      Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supported-token-types" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Token Types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supported-signature-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Signature algorithms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supported-encryption-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Encryption algorithms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supported-key-management-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Key Management algorithms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supported-elliptic-curves" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Elliptic Curves
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-a-new-lib" class="md-nav__link">
    <span class="md-ellipsis">
      Why a new lib?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#design" class="md-nav__link">
    <span class="md-ellipsis">
      Design
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Design">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tokens-are-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Tokens are objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#headers-are-auto-generated" class="md-nav__link">
    <span class="md-ellipsis">
      Headers are auto-generated
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jwk-as-thin-wrapper-around-cryptography-keys" class="md-nav__link">
    <span class="md-ellipsis">
      Jwk as thin wrapper around cryptography keys
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jwk-are-userdict-instances" class="md-nav__link">
    <span class="md-ellipsis">
      Jwk are UserDict instances
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jwa-wrappers" class="md-nav__link">
    <span class="md-ellipsis">
      JWA Wrappers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#safe-signature-verification" class="md-nav__link">
    <span class="md-ellipsis">
      Safe Signature Verification
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#todo" class="md-nav__link">
    <span class="md-ellipsis">
      TODO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#credits" class="md-nav__link">
    <span class="md-ellipsis">
      Credits
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    usage
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="recipes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    examples
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    contributing
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#features" class="md-nav__link">
    <span class="md-ellipsis">
      Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supported-token-types" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Token Types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supported-signature-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Signature algorithms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supported-encryption-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Encryption algorithms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supported-key-management-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Key Management algorithms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supported-elliptic-curves" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Elliptic Curves
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-a-new-lib" class="md-nav__link">
    <span class="md-ellipsis">
      Why a new lib?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#design" class="md-nav__link">
    <span class="md-ellipsis">
      Design
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Design">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tokens-are-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Tokens are objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#headers-are-auto-generated" class="md-nav__link">
    <span class="md-ellipsis">
      Headers are auto-generated
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jwk-as-thin-wrapper-around-cryptography-keys" class="md-nav__link">
    <span class="md-ellipsis">
      Jwk as thin wrapper around cryptography keys
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jwk-are-userdict-instances" class="md-nav__link">
    <span class="md-ellipsis">
      Jwk are UserDict instances
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jwa-wrappers" class="md-nav__link">
    <span class="md-ellipsis">
      JWA Wrappers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#safe-signature-verification" class="md-nav__link">
    <span class="md-ellipsis">
      Safe Signature Verification
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#todo" class="md-nav__link">
    <span class="md-ellipsis">
      TODO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#credits" class="md-nav__link">
    <span class="md-ellipsis">
      Credits
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>home</h1>

<!-- BEGIN INCLUDE ../README.md -->
<h2 id="_1"><img alt="jwskate" src="logo.png" /><a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p><a href="https://pypi.python.org/pypi/jwskate"><img alt="PyPi" src="https://img.shields.io/pypi/v/jwskate.svg" /></a>
<a href="https://pypi.python.org/pypi/jwskate"><img alt="PyPi - License" src="https://img.shields.io/pypi/l/jwskate" /></a>
<a href="https://pypi.python.org/pypi/jwskate"><img alt="PyPI - Downloads" src="https://img.shields.io/pypi/dw/jwskate" /></a>
<a href="https://github.com/astral-sh/ruff"><img alt="Code style: ruff" src="https://img.shields.io/badge/code%20style-ruff-000000.svg" /></a></p>
<p>A Pythonic implementation of the JOSE set of IETF specifications: <a href="https://www.rfc-editor.org/rfc/rfc7515.html">Json Web Signature</a>, <a href="https://www.rfc-editor.org/rfc/rfc7517.html">Keys</a>,
<a href="https://www.rfc-editor.org/rfc/rfc7518.html">Algorithms</a>, <a href="https://www.rfc-editor.org/rfc/rfc7519.html">Tokens</a> and <a href="https://www.rfc-editor.org/rfc/rfc7516.html">Encryption</a> (RFC7515 to 7519), hence the name <strong>JWSKATE</strong>, and
their extensions <a href="https://www.rfc-editor.org/rfc/rfc8037.html">ECDH Signatures</a> (RFC8037), <a href="https://www.rfc-editor.org/rfc/rfc7638.html">JWK Thumbprints</a> (RFC7638), and
<a href="https://www.rfc-editor.org/rfc/rfc9278.html">JWK Thumbprint URI</a> (RFC9278), with respects to <a href="https://www.rfc-editor.org/rfc/rfc8725">JWT Best Current Practices</a> (RFC8725).</p>
<ul>
<li>Free software: MIT</li>
<li>Repository: https://github.com/guillp/jwskate/</li>
<li>Documentation: https://guillp.github.io/jwskate/</li>
</ul>
<p>Here is a quick usage example: generating a private RSA key, signing some data, then validating that signature with the
matching public key:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="c1"># Let&#39;s generate a random private key, to use with alg &#39;RS256&#39;.</span>
<span class="c1"># Based on that alg, jwskate knows it must be an RSA key.</span>
<span class="c1"># RSA keys can be of any size, so let&#39;s pass the requested key size as parameter</span>
<span class="n">rsa_private_jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">alg</span><span class="o">=</span><span class="s2">&quot;RS256&quot;</span><span class="p">,</span> <span class="n">key_size</span><span class="o">=</span><span class="mi">2048</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Signing is easy!&quot;</span>  <span class="c1"># we will sign this</span>
<span class="n">signature</span> <span class="o">=</span> <span class="n">rsa_private_jwk</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># done!</span>

<span class="nb">print</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span>
<span class="c1"># b&#39;-\xe89\x81\xc4\xb9.G\x11\xa6\x93/dm\xf0\xc8\x0f\xd....&#39;</span>

<span class="c1"># now extract the public key, and verify the signature with it</span>
<span class="n">rsa_public_jwk</span> <span class="o">=</span> <span class="n">rsa_private_jwk</span><span class="o">.</span><span class="n">public_jwk</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">rsa_public_jwk</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">signature</span><span class="p">)</span>

<span class="c1"># let&#39;s see what a `Jwk` looks like:</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">UserDict</span>

<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rsa_private_jwk</span><span class="p">,</span> <span class="n">UserDict</span><span class="p">)</span>  <span class="c1"># Jwk are UserDicts</span>

<span class="nb">print</span><span class="p">(</span><span class="n">rsa_private_jwk</span><span class="o">.</span><span class="n">with_usage_parameters</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<p>The result of this print will look like this (with the random parts abbreviated to <code>...</code> for display purposes only):</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code>{&#39;kty&#39;: &#39;RSA&#39;,
 &#39;n&#39;: &#39;...&#39;,
 &#39;e&#39;: &#39;AQAB&#39;,
 &#39;d&#39;: &#39;...&#39;,
 &#39;p&#39;: &#39;...&#39;,
 &#39;q&#39;: &#39;...&#39;,
 &#39;dp&#39;: &#39;...&#39;,
 &#39;dq&#39;: &#39;...&#39;,
 &#39;qi&#39;: &#39;...&#39;,
 &#39;alg&#39;: &#39;RS256&#39;,
 &#39;kid&#39;: &#39;...&#39;,
 &#39;use&#39;: &#39;sig&#39;,
 &#39;key_ops&#39;: [&#39;sign&#39;]}
</code></pre></div></td></tr></table></div>
<p>Now let's sign a JWT containing arbitrary claims, this time using an Elliptic Curve (<code>EC</code>) key:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span><span class="p">,</span> <span class="n">Jwt</span>

<span class="c1"># This time let&#39;s try an EC key, based on `alg` parameter,</span>
<span class="c1"># and let&#39;s specify an arbitrary Key ID (kid).</span>
<span class="c1"># additional args are either options (like &#39;key_size&#39; above for RSA keys)</span>
<span class="c1"># or additional parameters to include in the JWK</span>
<span class="n">private_jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">alg</span><span class="o">=</span><span class="s2">&quot;ES256&quot;</span><span class="p">,</span> <span class="n">kid</span><span class="o">=</span><span class="s2">&quot;my_key&quot;</span><span class="p">)</span>
<span class="c1"># note that based only on the `alg` value, the appropriate key type and curve</span>
<span class="c1"># are automatically deduced and included in the JWK</span>
<span class="nb">print</span><span class="p">(</span><span class="n">private_jwk</span><span class="p">)</span>
<span class="c1"># {&#39;kty&#39;: &#39;EC&#39;, &#39;crv&#39;: &#39;P-256&#39;, &#39;x&#39;: &#39;Ppe...&#39;, &#39;y&#39;: &#39;9Si...&#39;, &#39;d&#39;: &#39;g09...&#39;, &#39;alg&#39;: &#39;ES256&#39;}</span>
<span class="k">assert</span> <span class="n">private_jwk</span><span class="o">.</span><span class="n">kty</span> <span class="o">==</span> <span class="s2">&quot;EC&quot;</span>
<span class="k">assert</span> <span class="n">private_jwk</span><span class="o">.</span><span class="n">crv</span> <span class="o">==</span> <span class="s2">&quot;P-256&quot;</span>
<span class="k">assert</span> <span class="n">private_jwk</span><span class="o">.</span><span class="n">alg</span> <span class="o">==</span> <span class="s2">&quot;ES256&quot;</span>
<span class="c1"># this is a private key and &#39;ES256&#39; is a signature alg, so &#39;use&#39; and &#39;key_ops&#39; can also be deduced:</span>
<span class="k">assert</span> <span class="n">private_jwk</span><span class="o">.</span><span class="n">use</span> <span class="o">==</span> <span class="s2">&quot;sig&quot;</span>
<span class="k">assert</span> <span class="n">private_jwk</span><span class="o">.</span><span class="n">key_ops</span> <span class="o">==</span> <span class="p">(</span><span class="s2">&quot;sign&quot;</span><span class="p">,)</span>

<span class="c1"># here are the claims to sign in a JWT:</span>
<span class="n">claims</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;sub&quot;</span><span class="p">:</span> <span class="s2">&quot;some_sub&quot;</span><span class="p">,</span> <span class="s2">&quot;claim1&quot;</span><span class="p">:</span> <span class="s2">&quot;value1&quot;</span><span class="p">}</span>

<span class="n">jwt</span> <span class="o">=</span> <span class="n">Jwt</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">claims</span><span class="p">,</span> <span class="n">private_jwk</span><span class="p">)</span>
<span class="c1"># that&#39;s it! we have a signed JWT.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">jwt</span><span class="p">)</span>
<span class="c1"># eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzb21lX3N1YiIsImNsYWltMSI6InZhbHVlMSJ9.SBQIlGlFdwoEMViWUFsBmCsXShtOq4lnp3Im5ZVh1PFCGJFdW-dTG9qJjlFSAA_BkM5PF9u38PL7Ai9cC2_DJw</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">jwt</span><span class="p">,</span> <span class="n">Jwt</span><span class="p">)</span>  <span class="c1"># Jwt are objects</span>
<span class="k">assert</span> <span class="n">jwt</span><span class="o">.</span><span class="n">claims</span> <span class="o">==</span> <span class="n">claims</span>  <span class="c1"># claims can be accessed as a dict</span>
<span class="k">assert</span> <span class="n">jwt</span><span class="o">.</span><span class="n">headers</span> <span class="o">==</span> <span class="p">{</span><span class="s2">&quot;typ&quot;</span><span class="p">:</span> <span class="s2">&quot;JWT&quot;</span><span class="p">,</span> <span class="s2">&quot;alg&quot;</span><span class="p">:</span> <span class="s2">&quot;ES256&quot;</span><span class="p">,</span> <span class="s2">&quot;kid&quot;</span><span class="p">:</span> <span class="s2">&quot;my_key&quot;</span><span class="p">}</span>  <span class="c1"># headers too</span>
<span class="k">assert</span> <span class="n">jwt</span><span class="o">.</span><span class="n">sub</span> <span class="o">==</span> <span class="s2">&quot;some_sub&quot;</span>  <span class="c1"># individual claims can be accessed as attributes</span>
<span class="k">assert</span> <span class="n">jwt</span><span class="p">[</span><span class="s2">&quot;claim1&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;value1&quot;</span>  <span class="c1"># or as dict items (with &quot;subscription&quot;)</span>
<span class="k">assert</span> <span class="n">jwt</span><span class="o">.</span><span class="n">alg</span> <span class="o">==</span> <span class="s2">&quot;ES256&quot;</span>  <span class="c1"># alg and kid headers are also accessible as attributes</span>
<span class="k">assert</span> <span class="n">jwt</span><span class="o">.</span><span class="n">kid</span> <span class="o">==</span> <span class="n">private_jwk</span><span class="o">.</span><span class="n">kid</span>
<span class="c1"># notice that alg and kid are automatically set with appropriate values taken from our private jwk</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">jwt</span><span class="o">.</span><span class="n">signature</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span>  <span class="c1"># signature is accessible too</span>
<span class="c1"># verifying the jwt signature is as easy as:</span>
<span class="k">assert</span> <span class="n">jwt</span><span class="o">.</span><span class="n">verify_signature</span><span class="p">(</span><span class="n">private_jwk</span><span class="o">.</span><span class="n">public_jwk</span><span class="p">())</span>
<span class="c1"># since our jwk contains an &#39;alg&#39; parameter (here &#39;ES256&#39;), the signature is automatically verified using that alg</span>
<span class="c1"># you could also specify an alg manually, useful for keys with no &quot;alg&quot; hint:</span>
<span class="k">assert</span> <span class="n">jwt</span><span class="o">.</span><span class="n">verify_signature</span><span class="p">(</span><span class="n">private_jwk</span><span class="o">.</span><span class="n">public_jwk</span><span class="p">(),</span> <span class="n">alg</span><span class="o">=</span><span class="s2">&quot;ES256&quot;</span><span class="p">)</span>
<span class="c1"># note that jwskate will only trust the alg(s) you provide as parameter, either part of the JWK</span>
<span class="c1"># or with `alg` or `algs` params, and will ignore the &#39;alg&#39; that is set in the JWT, for security reasons.</span>
</code></pre></div></td></tr></table></div>
<p>Now let's sign a JWT with the standardized lifetime, subject, audience and ID claims, plus arbitrary custom claims:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span><span class="p">,</span> <span class="n">JwtSigner</span>

<span class="n">private_jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">alg</span><span class="o">=</span><span class="s2">&quot;ES256&quot;</span><span class="p">)</span>
<span class="n">signer</span> <span class="o">=</span> <span class="n">JwtSigner</span><span class="p">(</span><span class="n">issuer</span><span class="o">=</span><span class="s2">&quot;https://myissuer.com&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">private_jwk</span><span class="p">)</span>
<span class="n">jwt</span> <span class="o">=</span> <span class="n">signer</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span>
    <span class="n">subject</span><span class="o">=</span><span class="s2">&quot;some_sub&quot;</span><span class="p">,</span>
    <span class="n">audience</span><span class="o">=</span><span class="s2">&quot;some_aud&quot;</span><span class="p">,</span>
    <span class="n">extra_claims</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;custom_claim1&quot;</span><span class="p">:</span> <span class="s2">&quot;value1&quot;</span><span class="p">,</span> <span class="s2">&quot;custom_claim2&quot;</span><span class="p">:</span> <span class="s2">&quot;value2&quot;</span><span class="p">},</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">jwt</span><span class="o">.</span><span class="n">claims</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>The generated JWT will include the standardized claims (<code>iss</code>, <code>aud</code>, <code>sub</code>, <code>iat</code>, <code>exp</code> and <code>jti</code>), together with the
<code>extra_claims</code> provided to <code>.sign()</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code>{&#39;custom_claim1&#39;: &#39;value1&#39;,
 &#39;custom_claim2&#39;: &#39;value2&#39;,
 &#39;iss&#39;: &#39;https://myissuer.com&#39;,
 &#39;aud&#39;: &#39;some_aud&#39;,
 &#39;sub&#39;: &#39;some_sub&#39;,
 &#39;iat&#39;: 1648823184,
 &#39;exp&#39;: 1648823244,
 &#39;jti&#39;: &#39;3b400e27-c111-4013-84e0-714acd76bf3a&#39;
}
</code></pre></div></td></tr></table></div>
<h3 id="features">Features<a class="headerlink" href="#features" title="Permanent link">&para;</a></h3>
<ul>
<li>Simple, Clean, Pythonic interface</li>
<li>Convenience wrappers around <code>cryptography</code> for all algorithms described in JWA</li>
<li>Json Web Keys (JWK) loading, dumping and generation</li>
<li>Arbitrary data signature and verification using Json Web Keys</li>
<li>Json Web Signatures (JWS) signing and verification</li>
<li>Json Web Encryption (JWE) encryption and decryption</li>
<li>Json Web Tokens (JWT) signing, verification and validation</li>
<li>100% type annotated, verified with <code>mypy --strict</code></li>
<li>nearly 100% code coverage</li>
<li>Relies on <a href="https://cryptography.io/..">cryptography</a> for all cryptographic operations</li>
<li>Relies on <a href="https://guillp.github.io/binapy/">BinaPy</a> for binary data manipulations</li>
</ul>
<h4 id="supported-token-types">Supported Token Types<a class="headerlink" href="#supported-token-types" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Token Type</th>
<th>Support</th>
</tr>
</thead>
<tbody>
<tr>
<td>Json Web Signature (JWS)</td>
<td>☑ Compact<br/> ☑ JSON Flat <br/> ☑ JSON General <br/></td>
</tr>
<tr>
<td>Json Web Encryption (JWE)</td>
<td>☑ Compact<br/> ☐ JSON Flat <br/> ☐ JSON General <br/></td>
</tr>
<tr>
<td>Json Web Tokens (JWT)</td>
<td>☑ Signed<br/> ☑ Signed and Encrypted</td>
</tr>
</tbody>
</table>
<h4 id="supported-signature-algorithms">Supported Signature algorithms<a class="headerlink" href="#supported-signature-algorithms" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Signature Alg</th>
<th>Description</th>
<th>Key Type</th>
<th>Reference</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>HS256</code></td>
<td>HMAC using SHA-256</td>
<td><code>oct</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-3.2">RFC7518, Section 3.2</a></td>
<td></td>
</tr>
<tr>
<td><code>HS384</code></td>
<td>HMAC using SHA-384</td>
<td><code>oct</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-3.2">RFC7518, Section 3.2</a></td>
<td></td>
</tr>
<tr>
<td><code>HS512</code></td>
<td>HMAC using SHA-512</td>
<td><code>oct</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-3.2">RFC7518, Section 3.2</a></td>
<td></td>
</tr>
<tr>
<td><code>RS256</code></td>
<td>RSASSA-PKCS1-v1_5 using SHA-256</td>
<td><code>RSA</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-3.3">RFC7518, Section 3.3</a></td>
<td></td>
</tr>
<tr>
<td><code>RS384</code></td>
<td>RSASSA-PKCS1-v1_5 using SHA-384</td>
<td><code>RSA</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-3.3">RFC7518, Section 3.3</a></td>
<td></td>
</tr>
<tr>
<td><code>RS512</code></td>
<td>RSASSA-PKCS1-v1_5 using SHA-512</td>
<td><code>RSA</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-3.3">RFC7518, Section 3.3</a></td>
<td></td>
</tr>
<tr>
<td><code>PS256</code></td>
<td>RSASSA-PSS using SHA-256 and MGF1 with SHA-256</td>
<td><code>RSA</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-3.5">RFC7518, Section 3.5</a></td>
<td></td>
</tr>
<tr>
<td><code>PS384</code></td>
<td>RSASSA-PSS using SHA-384 and MGF1 with SHA-384</td>
<td><code>RSA</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-3.5">RFC7518, Section 3.5</a></td>
<td></td>
</tr>
<tr>
<td><code>PS512</code></td>
<td>RSASSA-PSS using SHA-512 and MGF1 with SHA-512</td>
<td><code>RSA</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-3.5">RFC7518, Section 3.5</a></td>
<td></td>
</tr>
<tr>
<td><code>ES256</code></td>
<td>ECDSA using P-256 and SHA-256</td>
<td><code>EC</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-3.4">RFC7518, Section 3.4</a></td>
<td></td>
</tr>
<tr>
<td><code>ES384</code></td>
<td>ECDSA using P-384 and SHA-384</td>
<td><code>EC</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-3.4">RFC7518, Section 3.4</a></td>
<td></td>
</tr>
<tr>
<td><code>ES512</code></td>
<td>ECDSA using P-521 and SHA-512</td>
<td><code>EC</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-3.4">RFC7518, Section 3.4</a></td>
<td></td>
</tr>
<tr>
<td><code>ES256K</code></td>
<td>ECDSA using secp256k1 curve and SHA-256</td>
<td><code>EC</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc8812.html#name-ecdsa-signature-with-secp25">RFC8812, Section 3.2</a></td>
<td></td>
</tr>
<tr>
<td><code>EdDSA</code></td>
<td>EdDSA signature algorithms</td>
<td><code>OKP</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc8037.html#section-3.1">RFC8037, Section 3.1</a></td>
<td>Ed2219 and Ed448 are supported</td>
</tr>
<tr>
<td><code>HS1</code></td>
<td>HMAC using SHA-1</td>
<td><code>oct</code></td>
<td>https://www.w3.org/TR/WebCryptoAPI</td>
<td>Validation Only</td>
</tr>
<tr>
<td><code>RS1</code></td>
<td>RSASSA-PKCS1-v1_5 with SHA-1</td>
<td><code>RSA</code></td>
<td>https://www.w3.org/TR/WebCryptoAPI</td>
<td>Validation Only</td>
</tr>
<tr>
<td><code>none</code></td>
<td>No digital signature or MAC performed</td>
<td></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-3.6">RFC7518, Section 3.6</a></td>
<td>Not usable by mistake</td>
</tr>
</tbody>
</table>
<h4 id="supported-encryption-algorithms">Supported Encryption algorithms<a class="headerlink" href="#supported-encryption-algorithms" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Signature Alg</th>
<th>Description</th>
<th>Reference</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A128CBC-HS256</code></td>
<td>AES_128_CBC_HMAC_SHA_256 authenticated encryption algorithm</td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-5.2.3">RFC7518, Section 5.2.3</a></td>
</tr>
<tr>
<td><code>A192CBC-HS384</code></td>
<td>AES_192_CBC_HMAC_SHA_384 authenticated encryption algorithm</td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-5.2.4">RFC7518, Section 5.2.4</a></td>
</tr>
<tr>
<td><code>A256CBC-HS512</code></td>
<td>AES_256_CBC_HMAC_SHA_512 authenticated encryption algorithm</td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-5.2.5">RFC7518, Section 5.2.5</a></td>
</tr>
<tr>
<td><code>A128GCM</code></td>
<td>AES GCM using 128-bit key</td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-5.3">RFC7518, Section 5.3</a></td>
</tr>
<tr>
<td><code>A192GCM</code></td>
<td>AES GCM using 192-bit key</td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-5.3">RFC7518, Section 5.3</a></td>
</tr>
<tr>
<td><code>A256GCM</code></td>
<td>AES GCM using 256-bit key</td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-5.3">RFC7518, Section 5.3</a></td>
</tr>
</tbody>
</table>
<h4 id="supported-key-management-algorithms">Supported Key Management algorithms<a class="headerlink" href="#supported-key-management-algorithms" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Signature Alg</th>
<th>Description</th>
<th>Key Type</th>
<th>Reference</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>RSA1_5</code></td>
<td>RSAES-PKCS1-v1_5</td>
<td><code>RSA</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-4.2">RFC7518, Section 4.2</a></td>
<td>Unwrap Only</td>
</tr>
<tr>
<td><code>RSA-OAEP</code></td>
<td>RSAES OAEP using default parameters</td>
<td><code>RSA</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-4.3">RFC7518, Section 4.3</a></td>
<td></td>
</tr>
<tr>
<td><code>RSA-OAEP-256</code></td>
<td>RSAES OAEP using SHA-256 and MGF1 with SHA-256</td>
<td><code>RSA</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-4.3">RFC7518, Section 4.3</a></td>
<td></td>
</tr>
<tr>
<td><code>RSA-OAEP-384</code></td>
<td>RSA-OAEP using SHA-384 and MGF1 with SHA-384</td>
<td><code>RSA</code></td>
<td>https://www.w3.org/TR/WebCryptoAPI</td>
<td></td>
</tr>
<tr>
<td><code>RSA-OAEP-512</code></td>
<td>RSA-OAEP using SHA-512 and MGF1 with SHA-512</td>
<td><code>RSA</code></td>
<td>https://www.w3.org/TR/WebCryptoAPI</td>
<td></td>
</tr>
<tr>
<td><code>A128KW</code></td>
<td>AES Key Wrap using 128-bit key</td>
<td><code>oct</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-4.4">RFC7518, Section 4.4</a></td>
<td></td>
</tr>
<tr>
<td><code>A192KW</code></td>
<td>AES Key Wrap using 192-bit key</td>
<td><code>oct</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-4.4">RFC7518, Section 4.4</a></td>
<td></td>
</tr>
<tr>
<td><code>A256KW</code></td>
<td>AES Key Wrap using 256-bit key</td>
<td><code>oct</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-4.4">RFC7518, Section 4.4</a></td>
<td></td>
</tr>
<tr>
<td><code>A128GCMKW</code></td>
<td>Key wrapping with AES GCM using 128-bit key</td>
<td><code>oct</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-4.7">RFC7518, Section 4.7</a></td>
<td></td>
</tr>
<tr>
<td><code>A192GCMKW</code></td>
<td>Key wrapping with AES GCM using 192-bit key</td>
<td><code>oct</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-4.7">RFC7518, Section 4.7</a></td>
<td></td>
</tr>
<tr>
<td><code>A256GCMKW</code></td>
<td>Key wrapping with AES GCM using 256-bit key</td>
<td><code>oct</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-4.7">RFC7518, Section 4.7</a></td>
<td></td>
</tr>
<tr>
<td><code>dir</code></td>
<td>Direct use of a shared symmetric key</td>
<td><code>oct</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-4.5">RFC7518, Section 4.5</a></td>
<td></td>
</tr>
<tr>
<td><code>ECDH-ES</code></td>
<td>ECDH-ES using Concat KDF</td>
<td><code>EC</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-4.6">RFC7518, Section 4.6</a></td>
<td></td>
</tr>
<tr>
<td><code>ECDH-ES+A128KW</code></td>
<td>ECDH-ES using Concat KDF and "A128KW" wrapping</td>
<td><code>EC</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-4.6">RFC7518, Section 4.6</a></td>
<td></td>
</tr>
<tr>
<td><code>ECDH-ES+A192KW</code></td>
<td>ECDH-ES using Concat KDF and "A192KW" wrapping</td>
<td><code>EC</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-4.6">RFC7518, Section 4.6</a></td>
<td></td>
</tr>
<tr>
<td><code>ECDH-ES+A256KW</code></td>
<td>ECDH-ES using Concat KDF and "A256KW" wrapping</td>
<td><code>EC</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-4.6">RFC7518, Section 4.6</a></td>
<td></td>
</tr>
<tr>
<td><code>PBES2-HS256+A128KW</code></td>
<td>PBES2 with HMAC SHA-256 and "A128KW" wrapping</td>
<td><code>password</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-4.8">RFC7518, Section 4.8</a></td>
<td></td>
</tr>
<tr>
<td><code>PBES2-HS384+A192KW</code></td>
<td>PBES2 with HMAC SHA-384 and "A192KW" wrapping</td>
<td><code>password</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-4.8">RFC7518, Section 4.8</a></td>
<td></td>
</tr>
<tr>
<td><code>PBES2-HS512+A256KW</code></td>
<td>PBES2 with HMAC SHA-512 and "A256KW" wrapping</td>
<td><code>password</code></td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-4.8">RFC7518, Section 4.8</a></td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="supported-elliptic-curves">Supported Elliptic Curves<a class="headerlink" href="#supported-elliptic-curves" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Curve</th>
<th>Description</th>
<th>Key Type</th>
<th>Usage</th>
<th>Reference</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>P-256</code></td>
<td>P-256 Curve</td>
<td><code>EC</code></td>
<td>signature, encryption</td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-6.2.1.1">RFC7518, Section 6.2.1.1</a></td>
</tr>
<tr>
<td><code>P-384</code></td>
<td>P-384 Curve</td>
<td><code>EC</code></td>
<td>signature, encryption</td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-6.2.1.1">RFC7518, Section 6.2.1.1</a></td>
</tr>
<tr>
<td><code>P-521</code></td>
<td>P-521 Curve</td>
<td><code>EC</code></td>
<td>signature, encryption</td>
<td><a href="https://www.rfc-editor.org/rfc/rfc7518.html#section-6.2.1.1">RFC7518, Section 6.2.1.1</a></td>
</tr>
<tr>
<td><code>secp256k1</code></td>
<td>SECG secp256k1 curve</td>
<td><code>EC</code></td>
<td>signature, encryption</td>
<td><a href="https://www.rfc-editor.org/rfc/rfc8812.html#section-3.1">RFC8812, Section 3.1</a></td>
</tr>
<tr>
<td><code>Ed25519</code></td>
<td>Ed25519 signature algorithm key pairs</td>
<td><code>OKP</code></td>
<td>signature</td>
<td><a href="https://www.rfc-editor.org/rfc/rfc8037.html#section-3.1">RFC8037, Section 3.1</a></td>
</tr>
<tr>
<td><code>Ed448</code></td>
<td>Ed448 signature algorithm key pairs</td>
<td><code>OKP</code></td>
<td>signature</td>
<td><a href="https://www.rfc-editor.org/rfc/rfc8037.html#section-3.1">RFC8037, Section 3.1</a></td>
</tr>
<tr>
<td><code>X25519</code></td>
<td>X25519 function key pairs</td>
<td><code>OKP</code></td>
<td>encryption</td>
<td><a href="https://www.rfc-editor.org/rfc/rfc8037.html#section-3.2">RFC8037, Section 3.2</a></td>
</tr>
<tr>
<td><code>X448</code></td>
<td>X448 function key pairs</td>
<td><code>OKP</code></td>
<td>encryption</td>
<td><a href="https://www.rfc-editor.org/rfc/rfc8037.html#section-3.2">RFC8037, Section 3.2</a></td>
</tr>
</tbody>
</table>
<h3 id="why-a-new-lib">Why a new lib?<a class="headerlink" href="#why-a-new-lib" title="Permanent link">&para;</a></h3>
<p>There are already multiple modules implementing JOSE and Json Web Crypto related specifications in Python. However, I
have been dissatisfied by all of them so far, so I decided to come up with my own module.</p>
<ul>
<li><a href="https://pyjwt.readthedocs.io/..">PyJWT</a></li>
<li><a href="https://jwcrypto.readthedocs.io/">JWCrypto</a></li>
<li><a href="https://python-jose.readthedocs.io/">Python-JOSE</a></li>
<li><a href="https://docs.authlib.org/en/latest/jose/">AuthLib</a></li>
</ul>
<p>Not to say that those are <em>bad</em> libs (I actually use <code>jwcrypto</code> myself for <code>jwskate</code> unit tests), but they either don't
support some important features, lack documentation, or more generally have APIs that don't feel easy-enough,
Pythonic-enough to use. See <a href="..#Design">Design</a> below for some of the design decisions that lead to <code>jwskate</code>.</p>
<h3 id="design">Design<a class="headerlink" href="#design" title="Permanent link">&para;</a></h3>
<h4 id="tokens-are-objects">Tokens are objects<a class="headerlink" href="#tokens-are-objects" title="Permanent link">&para;</a></h4>
<p>Since JSON Web Tokens (JWT) are more and more used, JWT generation and validation must be as easy to do as possible. The
<code>Jwt</code> class wraps around a JWT value to allow easy access to its headers, claims and signature, and exposes methods to
easily verify the signature.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwt</span>

<span class="n">jwt</span> <span class="o">=</span> <span class="n">Jwt</span><span class="p">(</span>
    <span class="s2">&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c&quot;</span>
<span class="p">)</span>
<span class="k">assert</span> <span class="n">jwt</span><span class="o">.</span><span class="n">headers</span> <span class="o">==</span> <span class="p">{</span><span class="s2">&quot;alg&quot;</span><span class="p">:</span> <span class="s2">&quot;HS256&quot;</span><span class="p">,</span> <span class="s2">&quot;typ&quot;</span><span class="p">:</span> <span class="s2">&quot;JWT&quot;</span><span class="p">}</span>

<span class="k">assert</span> <span class="n">jwt</span><span class="o">.</span><span class="n">claims</span> <span class="o">==</span> <span class="p">{</span><span class="s2">&quot;sub&quot;</span><span class="p">:</span> <span class="s2">&quot;1234567890&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;John Doe&quot;</span><span class="p">,</span> <span class="s2">&quot;iat&quot;</span><span class="p">:</span> <span class="mi">1516239022</span><span class="p">}</span>

<span class="k">assert</span> <span class="p">(</span>
    <span class="n">jwt</span><span class="o">.</span><span class="n">signature</span>
    <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;I</span><span class="se">\xf9</span><span class="s2">J</span><span class="se">\xc7\x04</span><span class="s2">IH</span><span class="se">\xc7\x8a</span><span class="s2">(]</span><span class="se">\x90</span><span class="s2">O</span><span class="se">\x87\xf0\xa4\xc7\x89\x7f</span><span class="s2">~</span><span class="se">\x8f</span><span class="s2">:N</span><span class="se">\xb2</span><span class="s2">%_</span><span class="se">\xda</span><span class="s2">u</span><span class="se">\x0b</span><span class="s2">,</span><span class="se">\xc3\x97</span><span class="s2">&quot;</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><code>Jwt</code> instances always represent a syntactically valid JWT. If you try to initialize one with a malformed value, you
will get a <code>InvalidJwt</code> exception, with an helpful error message:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">jwt</span> <span class="o">=</span> <span class="n">Jwt</span><span class="p">(</span>
    <span class="s2">&quot;eyJhbGci-malformedheader.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c&quot;</span>
<span class="p">)</span>
<span class="c1"># jwskate.jwt.base.InvalidJwt: Invalid JWT header: it must be a Base64URL-encoded JSON object</span>
</code></pre></div></td></tr></table></div>
<p><code>Jwt</code> may be objects, but they are easy to serialize into their representation. Use either <code>str()</code> or <code>bytes()</code>
depending on what type of value you need, or the <code>value</code> attribute:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">jwt</span> <span class="o">=</span> <span class="n">Jwt</span><span class="p">(</span>
    <span class="s2">&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c&quot;</span>
<span class="p">)</span>
<span class="nb">str</span><span class="p">(</span><span class="n">jwt</span><span class="p">)</span>
<span class="c1"># &#39;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c&#39;</span>
<span class="nb">bytes</span><span class="p">(</span><span class="n">jwt</span><span class="p">)</span>
<span class="c1"># b&#39;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c&#39;</span>
<span class="k">assert</span> <span class="n">jwt</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">jwt</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>The same is true for JWS and JWE tokens.</p>
<h4 id="headers-are-auto-generated">Headers are auto-generated<a class="headerlink" href="#headers-are-auto-generated" title="Permanent link">&para;</a></h4>
<p>When signing a JWS, JWE or JWT, the headers are autogenerated by default, based on the used key and algorithm.</p>
<p>You may add your own custom headers using the <code>extra_headers</code> parameter, and/or set a custom <code>typ</code> header with the parameter of the same name:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">SymmetricJwk</span><span class="p">,</span> <span class="n">Jwt</span>

<span class="n">jwk</span> <span class="o">=</span> <span class="n">SymmetricJwk</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;T0t4llyR@nd0M&quot;</span><span class="p">,</span> <span class="n">kid</span><span class="o">=</span><span class="s2">&quot;symmetric_key1&quot;</span><span class="p">)</span>
<span class="n">jwt</span> <span class="o">=</span> <span class="n">Jwt</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span>
    <span class="n">claims</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;my&quot;</span><span class="p">:</span> <span class="s2">&quot;claims&quot;</span><span class="p">},</span>
    <span class="n">key</span><span class="o">=</span><span class="n">jwk</span><span class="p">,</span>
    <span class="n">alg</span><span class="o">=</span><span class="s2">&quot;HS256&quot;</span><span class="p">,</span>
    <span class="n">typ</span><span class="o">=</span><span class="s2">&quot;CustomJWT&quot;</span><span class="p">,</span>
    <span class="n">extra_headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;custom_header&quot;</span><span class="p">:</span> <span class="s2">&quot;custom_value&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">jwt</span><span class="p">)</span>
<span class="c1"># eyJhbGciOiJIUzI1NiIsImN1c3RvbV9oZWFkZXIiOiJjdXN0b21fdmFsdWUiLCJ0eXAiOiJDdXN0b21KV1QiLCJraWQiOiJzeW1tZXRyaWNfa2V5MSJ9.eyJteSI6ImNsYWltcyJ9.ZqCp8Crq-mdCXLoy5NiEdPTSUlIFEjrzexA6mKHrMAc</span>
<span class="nb">print</span><span class="p">(</span><span class="n">jwt</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
<span class="c1"># {&#39;alg&#39;: &#39;HS256&#39;, &#39;custom_header&#39;: &#39;custom_value&#39;, &#39;typ&#39;: &#39;CustomJWT&#39;, &#39;kid&#39;: &#39;symmetric_key1&#39;}</span>
</code></pre></div></td></tr></table></div>
<p>If, for testing purposes, you need to fully control which headers are included in the JWT, even if they are inconsistent,
you can use <code>Jwt.sign_arbitrary()</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">SymmetricJwk</span><span class="p">,</span> <span class="n">Jwt</span>

<span class="n">jwk</span> <span class="o">=</span> <span class="n">SymmetricJwk</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;T0t4llyR@nd0M&quot;</span><span class="p">,</span> <span class="n">kid</span><span class="o">=</span><span class="s2">&quot;symmetric_key1&quot;</span><span class="p">)</span>
<span class="n">jwt</span> <span class="o">=</span> <span class="n">Jwt</span><span class="o">.</span><span class="n">sign_arbitrary</span><span class="p">(</span>
    <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;custom_header&quot;</span><span class="p">:</span> <span class="s2">&quot;custom_value&quot;</span><span class="p">,</span>
        <span class="s2">&quot;typ&quot;</span><span class="p">:</span> <span class="s2">&quot;WeirdJWT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;kid&quot;</span><span class="p">:</span> <span class="s2">&quot;R@nd0m_KID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;alg&quot;</span><span class="p">:</span> <span class="s2">&quot;WeirdAlg&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">claims</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;my&quot;</span><span class="p">:</span> <span class="s2">&quot;claims&quot;</span><span class="p">},</span>
    <span class="n">key</span><span class="o">=</span><span class="n">jwk</span><span class="p">,</span>
    <span class="n">alg</span><span class="o">=</span><span class="s2">&quot;HS256&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">jwt</span><span class="p">)</span>
<span class="c1"># eyJjdXN0b21faGVhZGVyIjoiY3VzdG9tX3ZhbHVlIiwidHlwIjoiV2VpcmRKV1QiLCJraWQiOiJSQG5kMG1fS0lEIiwiYWxnIjoiV2VpcmRBbGcifQ.eyJteSI6ImNsYWltcyJ9.bcTFqCSiVIbyJhxClgsBDIyhbvLXTOXOV55QGqo2mhw</span>
<span class="nb">print</span><span class="p">(</span><span class="n">jwt</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>  <span class="c1"># you asked for inconsistent headers, you have them:</span>
<span class="c1"># {&#39;custom_header&#39;: &#39;custom_value&#39;, &#39;typ&#39;: &#39;WeirdJWT&#39;, &#39;kid&#39;: &#39;R@nd0m_KID&#39;, &#39;alg&#39;: &#39;WeirdAlg&#39;}</span>
</code></pre></div></td></tr></table></div>
<h4 id="jwk-as-thin-wrapper-around-cryptography-keys"><code>Jwk</code> as thin wrapper around <code>cryptography</code> keys<a class="headerlink" href="#jwk-as-thin-wrapper-around-cryptography-keys" title="Permanent link">&para;</a></h4>
<p><code>Jwk</code> keys are just <em>thin</em> wrappers around keys from the <code>cryptography</code> module, or, in the case of symmetric keys,
around <code>bytes</code>. But, unlike <code>cryptography</code>keys, they present a consistent interface for signature creation/verification,
key management, and encryption/decryption, with all available algorithms.</p>
<p>Everywhere a key is required as parameter, you may pass either a raw <code>cryptography</code> key instance, or a <code>Jwk</code> instance
(which is actually a thin wrapper around a cryptography key), or a <code>Mapping</code> representing the JWK key.</p>
<h4 id="jwk-are-userdict-instances"><code>Jwk</code> are <code>UserDict</code> instances<a class="headerlink" href="#jwk-are-userdict-instances" title="Permanent link">&para;</a></h4>
<p>JWK are specified as JSON objects, which are parsed as <code>dict</code> in Python. The <code>Jwk</code> class in <code>jwskate</code> is actually a
<code>UserDict</code> subclass, which is very similar to a standard <code>dict</code>. So you can use it exactly like you would use a <code>dict</code>:
you can access its members, dump it back as JSON, etc. The same is true for Signed or Encrypted Json Web tokens in JSON
format. However, you cannot change the key cryptographic materials, since that would lead to unusable keys.</p>
<p>Note that the keys with a <code>JwkSet</code> are converted to instances of <code>Jwk</code> on initialization. This may introduce an issue
if you try to serialize it to JSON with the standard <code>json</code> module, which does not handle <code>UserDict</code> by default. You may
either use <code>JwkSet.to_json()</code> to get a JSON-serialized string, or <code>JwkSet.to_dict()</code> to get a standard <code>dict</code>, that is
serializable by the standard <code>json</code> module.</p>
<h4 id="jwa-wrappers">JWA Wrappers<a class="headerlink" href="#jwa-wrappers" title="Permanent link">&para;</a></h4>
<p>You can use <code>cryptography</code> to do the cryptographic operations that are described in
<a href="https://www.rfc-editor.org/info/rfc7518">JWA</a>, but since <code>cryptography</code> is a general purpose library, its usage is not
straightforward and gives you plenty of options to carefully select and combine, leaving room for mistakes, errors and
confusion. It also has a quite inconsistent API to handle the different key types and algorithms. To work around this,
<code>jwskate</code> comes with a set of consistent wrappers that implement the exact JWA specifications, with minimum risk of
mistakes.</p>
<h4 id="safe-signature-verification">Safe Signature Verification<a class="headerlink" href="#safe-signature-verification" title="Permanent link">&para;</a></h4>
<p>As advised in <a href="https://www.rfc-editor.org/rfc/rfc8725">JWT Best Practices</a> $3.1:</p>
<p>For every signature verification method in <code>jwskate</code>, the expected signature(s) algorithm(s) must be specified. That is
to avoid a security flaw where your application accepts tokens with a weaker encryption scheme than what your security
policy mandates; or even worse, where it accepts unsigned tokens, or tokens that are symmetrically signed with an
improperly used public key, leaving your application exposed to exploitation by attackers.</p>
<p>To specify which signature algorithms are accepted, each signature verification method accepts, in order of preference:</p>
<ul>
<li>an <code>alg</code> parameter which contains the expected algorithm, or an <code>algs</code> parameter which contains a list of acceptable
  algorithms</li>
<li>the <code>alg</code> parameter from the signature verification <code>Jwk</code>, if present. This <code>alg</code> is the algorithm intended for use
  with that key.</li>
</ul>
<p>Note that you cannot use <code>alg</code> and <code>algs</code> at the same time. If your <code>Jwk</code> contains an <code>alg</code> parameter, and you provide
an <code>alg</code> or <code>algs</code> which does not match that value, a <code>Warning</code> will be emitted.</p>
<h3 id="todo">TODO<a class="headerlink" href="#todo" title="Permanent link">&para;</a></h3>
<ul>
<li>Complete/enhance/proof-read documentation</li>
<li>Better exceptions (create dedicated exception classes, better messages, etc.)</li>
<li>Support for JWE in JSON format</li>
<li>Better tests</li>
<li>Support for Selective-Disclosure JWT</li>
</ul>
<h3 id="credits">Credits<a class="headerlink" href="#credits" title="Permanent link">&para;</a></h3>
<p>All cryptographic operations are handled by <a href="https://cryptography.io/..">cryptography</a>.</p>
<!-- END INCLUDE -->












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/guillp/jwskate" target="_blank" rel="noopener" title="Github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:guill.p.linux@gmail.com" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.indexes", "navigation.tabs", "navigation.instant", "navigation.tabs.sticky"], "search": "assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.e1c3ead8.min.js"></script>
      
    
  </body>
</html>