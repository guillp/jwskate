
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://guillp.github.io/jwskate/usage/">
      
      
        <link rel="prev" href="../installation/">
      
      
        <link rel="next" href="../recipes/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.2">
    
    
      
        <title>usage - jwskate</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.d451bc0e.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.a5377069.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#usage" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="jwskate" class="md-header__button md-logo" aria-label="jwskate" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            jwskate
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              usage
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/guillp/jwskate" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jwskate
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../installation/" class="md-tabs__link">
        
  
    
  
  installation

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  usage

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../recipes/" class="md-tabs__link">
        
  
    
  
  examples

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../api/" class="md-tabs__link">
        
  
    
  
  API

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../contributing/" class="md-tabs__link">
        
  
    
  
  contributing

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="jwskate" class="md-nav__button md-logo" aria-label="jwskate" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    jwskate
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/guillp/jwskate" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jwskate
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    usage
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    usage
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cheat-sheet" class="md-nav__link">
    Cheat Sheet
  </a>
  
    <nav class="md-nav" aria-label="Cheat Sheet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generating-new-keys" class="md-nav__link">
    Generating new keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loading-keys" class="md-nav__link">
    Loading keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#saving-keys" class="md-nav__link">
    Saving keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inspecting-keys" class="md-nav__link">
    Inspecting keys
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jwk" class="md-nav__link">
    JWK
  </a>
  
    <nav class="md-nav" aria-label="JWK">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#loading-keys_1" class="md-nav__link">
    Loading keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-key-parameters" class="md-nav__link">
    Getting key parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-keys" class="md-nav__link">
    Generating keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#private-and-public-keys" class="md-nav__link">
    Private and Public Keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dumping-keys" class="md-nav__link">
    Dumping keys
  </a>
  
    <nav class="md-nav" aria-label="Dumping keys">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-json" class="md-nav__link">
    to JSON
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-cryptography-keys" class="md-nav__link">
    to cryptography keys
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signing-and-verifying-data" class="md-nav__link">
    Signing and verifying data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encrypting-and-decrypting-data" class="md-nav__link">
    Encrypting and Decrypting data
  </a>
  
    <nav class="md-nav" aria-label="Encrypting and Decrypting data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authenticated-encryption" class="md-nav__link">
    Authenticated encryption
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-management" class="md-nav__link">
    Key Management
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jws" class="md-nav__link">
    JWS
  </a>
  
    <nav class="md-nav" aria-label="JWS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parsing-tokens" class="md-nav__link">
    Parsing tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifying-tokens" class="md-nav__link">
    Verifying tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signing-tokens" class="md-nav__link">
    Signing tokens
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jwe" class="md-nav__link">
    JWE
  </a>
  
    <nav class="md-nav" aria-label="JWE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parsing-and-decrypting-jwe-tokens" class="md-nav__link">
    Parsing and decrypting JWE tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encrypting-jwe-tokens" class="md-nav__link">
    Encrypting JWE tokens
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jwt" class="md-nav__link">
    JWT
  </a>
  
    <nav class="md-nav" aria-label="JWT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parsing-jwt-tokens" class="md-nav__link">
    Parsing JWT tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validating-jwt-tokens" class="md-nav__link">
    Validating JWT tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signing-jwt-tokens" class="md-nav__link">
    Signing JWT tokens
  </a>
  
    <nav class="md-nav" aria-label="Signing JWT tokens">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jwt-headers" class="md-nav__link">
    JWT headers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../recipes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    examples
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    contributing
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cheat-sheet" class="md-nav__link">
    Cheat Sheet
  </a>
  
    <nav class="md-nav" aria-label="Cheat Sheet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generating-new-keys" class="md-nav__link">
    Generating new keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loading-keys" class="md-nav__link">
    Loading keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#saving-keys" class="md-nav__link">
    Saving keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inspecting-keys" class="md-nav__link">
    Inspecting keys
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jwk" class="md-nav__link">
    JWK
  </a>
  
    <nav class="md-nav" aria-label="JWK">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#loading-keys_1" class="md-nav__link">
    Loading keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-key-parameters" class="md-nav__link">
    Getting key parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-keys" class="md-nav__link">
    Generating keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#private-and-public-keys" class="md-nav__link">
    Private and Public Keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dumping-keys" class="md-nav__link">
    Dumping keys
  </a>
  
    <nav class="md-nav" aria-label="Dumping keys">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-json" class="md-nav__link">
    to JSON
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-cryptography-keys" class="md-nav__link">
    to cryptography keys
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signing-and-verifying-data" class="md-nav__link">
    Signing and verifying data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encrypting-and-decrypting-data" class="md-nav__link">
    Encrypting and Decrypting data
  </a>
  
    <nav class="md-nav" aria-label="Encrypting and Decrypting data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authenticated-encryption" class="md-nav__link">
    Authenticated encryption
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-management" class="md-nav__link">
    Key Management
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jws" class="md-nav__link">
    JWS
  </a>
  
    <nav class="md-nav" aria-label="JWS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parsing-tokens" class="md-nav__link">
    Parsing tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifying-tokens" class="md-nav__link">
    Verifying tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signing-tokens" class="md-nav__link">
    Signing tokens
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jwe" class="md-nav__link">
    JWE
  </a>
  
    <nav class="md-nav" aria-label="JWE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parsing-and-decrypting-jwe-tokens" class="md-nav__link">
    Parsing and decrypting JWE tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encrypting-jwe-tokens" class="md-nav__link">
    Encrypting JWE tokens
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jwt" class="md-nav__link">
    JWT
  </a>
  
    <nav class="md-nav" aria-label="JWT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parsing-jwt-tokens" class="md-nav__link">
    Parsing JWT tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validating-jwt-tokens" class="md-nav__link">
    Validating JWT tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signing-jwt-tokens" class="md-nav__link">
    Signing JWT tokens
  </a>
  
    <nav class="md-nav" aria-label="Signing JWT tokens">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jwt-headers" class="md-nav__link">
    JWT headers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>usage</h1>

<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<p>To use <code>jwskate</code> in a project, you can import all exposed objects from the root module:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>from jwskate import *
</code></pre></div></td></tr></table></div>
<h2 id="cheat-sheet">Cheat Sheet<a class="headerlink" href="#cheat-sheet" title="Permanent link">&para;</a></h2>
<h3 id="generating-new-keys">Generating new keys<a class="headerlink" href="#generating-new-keys" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Usage</th>
<th>Method</th>
</tr>
</thead>
<tbody>
<tr>
<td>For a specific algorithm</td>
<td><code>Jwk.generate(alg='ES256')</code></td>
</tr>
<tr>
<td>For a specific key type</td>
<td><code>Jwk.generate(kty='RSA')</code></td>
</tr>
</tbody>
</table>
<h3 id="loading-keys">Loading keys<a class="headerlink" href="#loading-keys" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>From</th>
<th>Method</th>
</tr>
</thead>
<tbody>
<tr>
<td>A JWK in Python dict</td>
<td><code>jwk = Jwk({'kty': 'RSA', 'n': '...', ...})</code></td>
</tr>
<tr>
<td>A JWK in JSON formatted string</td>
<td><code>jwk = Jwk('{"kty": "RSA", "n": "...", ...}')</code></td>
</tr>
<tr>
<td>A<code>cryptography</code> key</td>
<td><code>jwk = Jwk(cryptography_key)</code></td>
</tr>
<tr>
<td>A public key in a PEM formatted string</td>
<td><code>jwk = Jwk.from_pem(</code><br/><code>'''-----BEGIN PUBLIC KEY----- MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAp0VYc2zc/6yNzQUSFprv</code><br/><code>... 3QIDAQAB</code><br/><code>-----END PUBLIC KEY----- '''</code><br/><code>)</code></td>
</tr>
<tr>
<td>A private key in a PEM formatted string</td>
<td><code>jwk = Jwk.from_pem(</code><br/><code>'''-----BEGIN PRIVATE KEY----- MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAp0VYc2zc/6yNzQUSFprv</code><br/><code>... 3QIDAQAB</code><br/><code>-----END PRIVATE KEY----- ''',</code><br/> <code>password=b'password_if_any'</code><br/> <code>)</code></td>
</tr>
<tr>
<td>A private key in a DER binary</td>
<td><code>jwk = Jwk.from_der(b'der_formatted_binary')</code></td>
</tr>
</tbody>
</table>
<h3 id="saving-keys">Saving keys<a class="headerlink" href="#saving-keys" title="Permanent link">&para;</a></h3>
<p>From an instance of a <code>Jwk</code> named <code>jwk</code>:</p>
<table>
<thead>
<tr>
<th>To</th>
<th>Method</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>A JWK in Python dict</td>
<td><code>jwk</code> # Jwk is a dict subclass</td>
<td>you may also do<code>dict(jwk)</code></td>
</tr>
<tr>
<td>A JWK in JSON formatted string</td>
<td><code>jwk.to_json()</code></td>
<td></td>
</tr>
<tr>
<td>A cryptography key</td>
<td><code>jwk.cryptography_key</code></td>
<td></td>
</tr>
<tr>
<td>A PEM formatted string</td>
<td><code>jwk.to_pem(password="mypassword")</code></td>
<td>password is optional</td>
</tr>
<tr>
<td>A symmetric key, as bytes</td>
<td><code>jwk.key</code></td>
<td>only works with kty=oct</td>
</tr>
<tr>
<td>A JWKS</td>
<td><code>jwk.as_jwks()</code></td>
<td>will contain<code>jwk</code> as single key</td>
</tr>
</tbody>
</table>
<h3 id="inspecting-keys">Inspecting keys<a class="headerlink" href="#inspecting-keys" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Usage</th>
<th>Method</th>
<th>Returns</th>
</tr>
</thead>
<tbody>
<tr>
<td>Check privateness</td>
<td><code>jwk.is_private()</code></td>
<td><code>bool</code></td>
</tr>
<tr>
<td>Check symmetricness</td>
<td><code>jwk.is_symmetric()</code></td>
<td><code>bool</code></td>
</tr>
<tr>
<td>Get Key Type</td>
<td><code>jwk.kty</code></td>
<td>key type, as<code>str</code></td>
</tr>
<tr>
<td>Get Alg (if present)</td>
<td><code>jwk.alg</code></td>
<td>intended algorithm identifier, as<code>str</code></td>
</tr>
<tr>
<td>Get Use</td>
<td><code>jwk.use</code></td>
<td>intended key use, if present, or deduced from<code>alg</code></td>
</tr>
<tr>
<td>Get Key Ops</td>
<td><code>jwk.key_ops</code></td>
<td>intended key operations, if present,<br>or deduced from <code>use</code>, <code>kty</code>, privateness and symmetricness</td>
</tr>
<tr>
<td>Get attributes</td>
<td><code>jwk['attribute']</code><br><code>jwk.attribute</code></td>
<td>attribute value</td>
</tr>
<tr>
<td>Get thumbprint</td>
<td><code>jwk.thumbprint()</code><br><code>jwk.thumbprint_uri()</code></td>
<td>Computed thumbprint or thumbprint URI</td>
</tr>
<tr>
<td>Get supported algorithms</td>
<td><code>jwk.supported_signing_algorithms()</code><br><code>jwk.supported_key_management_algorithms()</code><br><code>jwk.supported_encryption_algorithms()</code></td>
<td>List of supported algorithms identifiers, as<code>str</code>.</td>
</tr>
</tbody>
</table>
<h2 id="jwk">JWK<a class="headerlink" href="#jwk" title="Permanent link">&para;</a></h2>
<h3 id="loading-keys_1">Loading keys<a class="headerlink" href="#loading-keys_1" title="Permanent link">&para;</a></h3>
<p>The <code>Jwk</code> class and its subclasses represent keys in JWK format. You can initialize a Jwk from:</p>
<ul>
<li>a dict representing the JWK content, already parsed from JSON:</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="n">jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span>
        <span class="s2">&quot;crv&quot;</span><span class="p">:</span> <span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;WtjnvHG9b_IKBLn4QYTHz-AdoAiO_ork5LH1BL_5tyI&quot;</span><span class="p">,</span>
        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;C0YfOUDuCOvTCt7hAqO-f9z8_JdOnOPbfYmUk-RosHA&quot;</span><span class="p">,</span>
        <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="s2">&quot;EnGZlkoa4VUsnl72LcRRychNJ2FFknm_ph855tNuPZ8&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>a string containing a JSON representation of the JWK:</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="n">jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="p">(</span>
    <span class="s1">&#39;{&quot;kty&quot;: &quot;EC&quot;, &quot;crv&quot;: &quot;P-256&quot;,&#39;</span>
    <span class="s1">&#39;x&quot;: &quot;WtjnvHG9b_IKBLn4QYTHz-AdoAiO_ork5LH1BL_5tyI&quot;,&#39;</span>
    <span class="s1">&#39;y&quot;: &quot;C0YfOUDuCOvTCt7hAqO-f9z8_JdOnOPbfYmUk-RosHA&quot;,&#39;</span>
    <span class="s1">&#39;d&quot;: &quot;EnGZlkoa4VUsnl72LcRRychNJ2FFknm_ph855tNuPZ8&quot;}&#39;</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>a <code>cryptography</code> key:</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives.asymmetric</span> <span class="kn">import</span> <span class="n">ec</span>

<span class="n">key</span> <span class="o">=</span> <span class="n">ec</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">(</span><span class="n">ec</span><span class="o">.</span><span class="n">SECP256R1</span><span class="p">)</span>
<span class="n">jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>a public or private key in PEM format, optionally protected by a password:</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="n">public_jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">from_pem</span><span class="p">(</span>
<span class="w">    </span><span class="sa">b</span><span class="sd">&quot;&quot;&quot;-----BEGIN PUBLIC KEY-----</span>
<span class="sd">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsjtGIk8SxD+OEiBpP2/T</span>
<span class="sd">JUAF0upwuKGMk6wH8Rwov88VvzJrVm2NCticTk5FUg+UG5r8JArrV4tJPRHQyvqK</span>
<span class="sd">wF4NiksuvOjv3HyIf4oaOhZjT8hDne1Bfv+cFqZJ61Gk0MjANh/T5q9vxER/7TdU</span>
<span class="sd">NHKpoRV+NVlKN5bEU/NQ5FQjVXicfswxh6Y6fl2PIFqT2CfjD+FkBPU1iT9qyJYH</span>
<span class="sd">A38IRvwNtcitFgCeZwdGPoxiPPh1WHY8VxpUVBv/2JsUtrB/rAIbGqZoxAIWvijJ</span>
<span class="sd">Pe9o1TY3VlOzk9ASZ1AeatvOir+iDVJ5OpKmLnzc46QgGPUsjIyo6Sje9dxpGtoG</span>
<span class="sd">QQIDAQAB</span>
<span class="sd">-----END PUBLIC KEY-----&quot;&quot;&quot;</span>
<span class="p">)</span>

<span class="n">private_jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">from_pem</span><span class="p">(</span>
<span class="w">    </span><span class="sa">b</span><span class="sd">&quot;&quot;&quot;-----BEGIN RSA PRIVATE KEY-----</span>
<span class="sd">MIIEpAIBAAKCAQEAywYF71cKSo3xyi7/0S7N1blFCmBX4eZz0gXf+zyBfomuqhwr</span>
<span class="sd">....</span>
<span class="sd">daBAqhoDEr4SoKju8pagw6lqm65XeARyWkxqFqAZbb2K3bWY3x9qZT6oubLrCDGD</span>
<span class="sd">-----END RSA PRIVATE KEY-----&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;P@ssw0rd&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="getting-key-parameters">Getting key parameters<a class="headerlink" href="#getting-key-parameters" title="Permanent link">&para;</a></h3>
<p>Once you have a <code>Jwk</code> instance, you can access its parameters either by using subscription or attributes:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="n">jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span>
        <span class="s2">&quot;crv&quot;</span><span class="p">:</span> <span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;WtjnvHG9b_IKBLn4QYTHz-AdoAiO_ork5LH1BL_5tyI&quot;</span><span class="p">,</span>
        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;C0YfOUDuCOvTCt7hAqO-f9z8_JdOnOPbfYmUk-RosHA&quot;</span><span class="p">,</span>
        <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="s2">&quot;EnGZlkoa4VUsnl72LcRRychNJ2FFknm_ph855tNuPZ8&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="k">assert</span> <span class="n">jwk</span><span class="o">.</span><span class="n">kty</span> <span class="o">==</span> <span class="s2">&quot;EC&quot;</span>
<span class="k">assert</span> <span class="n">jwk</span><span class="o">.</span><span class="n">crv</span> <span class="o">==</span> <span class="s2">&quot;P-256&quot;</span>
<span class="k">assert</span> <span class="n">jwk</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;WtjnvHG9b_IKBLn4QYTHz-AdoAiO_ork5LH1BL_5tyI&quot;</span>
<span class="k">assert</span> <span class="n">jwk</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">jwk</span><span class="o">.</span><span class="n">x</span>
</code></pre></div></td></tr></table></div>
<p>Those will return the exact (usually base64url-encoded) value, exactly as expressed in the JWK. You can also get the
real, decoded parameters with some special attributes, which depend on the key type (thus on the <code>Jwk</code> subclass):</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="n">jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span>
        <span class="s2">&quot;crv&quot;</span><span class="p">:</span> <span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;WtjnvHG9b_IKBLn4QYTHz-AdoAiO_ork5LH1BL_5tyI&quot;</span><span class="p">,</span>
        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;C0YfOUDuCOvTCt7hAqO-f9z8_JdOnOPbfYmUk-RosHA&quot;</span><span class="p">,</span>
        <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="s2">&quot;EnGZlkoa4VUsnl72LcRRychNJ2FFknm_ph855tNuPZ8&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="k">assert</span> <span class="p">(</span>
    <span class="n">jwk</span><span class="o">.</span><span class="n">x_coordinate</span>
    <span class="o">==</span> <span class="mi">41091394722340406951651919287101979028566994134304719828008599584440827098914</span>
<span class="p">)</span>
<span class="k">assert</span> <span class="p">(</span>
    <span class="n">jwk</span><span class="o">.</span><span class="n">y_coordinate</span>
    <span class="o">==</span> <span class="mi">5099336126642036233987555101153084413345413137896124327269101893088581300336</span>
<span class="p">)</span>
<span class="k">assert</span> <span class="p">(</span>
    <span class="n">jwk</span><span class="o">.</span><span class="n">ecc_private_key</span>
    <span class="o">==</span> <span class="mi">8342345011805978907621665437908035545366143771247820774310445528411160853919</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>The available special attributes vary depending on the key type.</p>
<h3 id="generating-keys">Generating keys<a class="headerlink" href="#generating-keys" title="Permanent link">&para;</a></h3>
<p><code>jwskate</code> can generate private keys from any of it supported key types. To generate a key, use <code>Jwk.generate()</code>. It just
needs some hints to know what kind of key to generate, either an identifier for the algorithm that will be used with
that key (<code>alg</code>), or a key type (<code>kty</code>). An <code>alg</code> is preferred, since it gives more hints to generate a key that is suitable
for its purpose. Those hints include the Elliptic Curve to use, or the key size to generate. The specified <code>alg</code> will be part of the generated key, and will avoid having to
specify the alg for every cryptographic operation you will perform with that key.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="c1"># specifying an alg:</span>
<span class="n">rsa_jwk_RS256</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">alg</span><span class="o">=</span><span class="s2">&quot;RS256&quot;</span><span class="p">)</span>
<span class="c1"># &#39;kty&#39;: &#39;RSA&#39;, &#39;n&#39;: &#39;0o-yPaR-e7yr3l3pA7CFwGpHu3QSGhEK50w_qeK0UGD2hmqNCRxD5cAYJ1JKltgcsmSQ4b94_DPdJjRaNdyJbX15cF25tVtoPRW6g5_kgiIpTzrDFcVTY0CJ0DHztnkG9IitC-xBRJSgJd2SPyL9j1bSfdWPjvaq1Z8LhxjUauUNaQmIkVw_ji-eGksClF-3Nv9l3s3V7sCbHaVLL6pQ1KV2SXW327xACHp5wbwtEociBRQWNMGoNpQz0k1dhTsfQTz2xOwKn-iETTySZSNnP6cvOjwlz2t5KjZNns3CBYKWw9z0AqLJ_99_y14q3krxpauuOQ_uh3Y_qPNSaFoUfjp5NuvAlVuptW3dzgf86Svb8KF7mmx0oC328FY_VCusUuKuis-lgX_P-_f-wTXEiXQkHjaekNDd8YFyssDu6NKWH8IfKR53NCtShLslNvifkQxIUOP6gVrMCvTr4oOAYQsw2K3C92CNfmavYsLtej0A-j7La-NeHuYX9UoWQimSefChw0LZ4unVahMqb6nb7C3_FVv7nLJzupahpmERTKDqv09Kw060KvMKv-OSd8sK_Zzfv5emjZmNaZTVBCAu5OVZBOVRKmzEPT9K0g-63DdLOlNmS_4Ns6qCzrFdc9Fy6HiJB60xOpZ-EBU7Ft_rr5YmtTrAW_oguHiN-hku0Vk&#39;, &#39;e&#39;: &#39;AQAB&#39;, &#39;d&#39;: &#39;INc-t_SRsbTsothyK8bQJaxYlyPJtafA0_CFjCFgJEVAo223pPBz-pU_xH-bmJ6zuHM3pwNugvoyh5nqFAqF-L4gPxFZ51pkDgWh5ej-AqSssr8khvRpnB-zHvYbip33zWi1LMM4LtJ2OVGvVLTyvUo6YbFPHGoxR55FywK-vBQQ8mKv7-lmaZktsfDPFzCSlTu3uiIlOCwcRWnEKfazeBHSkC88ckOQl9dFFEgdnjfWFjAFgqGjHdgho68ODhCkQFBE4NPmmFLzXPnnOhUP2SgMlVWk7rlW2D7zU6Md8YQRBb15kCEEcSnSdyKvJvqjaUaMpuPAPVUzz_hw0EvJyYSLYQMtI5gLhVZzKeTV_dsfB7QPJR9Q03lktwZOLzLqoRucC9nTiT_g7gsBUMBi6LRD34Krd_YGp4A24tynzMlD8KATO1oU4QSdVvxPGticKGUntEJcUAkq00aMKv9zrb1WBUDIIccf6UKbjj2tj3r9hUASg1xHrlZmIhXK9xe3FeNP34dp_5ACLfl9JQzorzoNsaNgf0swD2ww_-wSsUbxfpow1RYtfS9aKpbJGADx-gyGReRU8YVie3SJ1yfur90EvIbq4eIVdMFklQGbbMnR291DZNJM0e_RNzOSMj574rNaq_7Tq5uMNaoFfAc2rKZDdL-Ze9e6YD7UO10WpB0&#39;, &#39;p&#39;: &#39;5MC2kUwy3I4hyQwk4ikh201IZEw_onOktcQAT3QSl6R_zlUMb8j9lR1-_7R5xNeQsUaN3gXuEzlAbuTAS7EgF_WcvEsYyi_Eqn2B_o2QAUUJXEtNqyeC5Q2bGLXM5Yl0nqaMOpI5lsoAK4CfTe0L6B3AeriFhlTPI-LY8_PrtbeSf06NHuJ2_1XqZVE-tQiDlKu29zWntOJ8L-0f9ABA1q6ixSX4hCa3QyE3_4hGgxH8pskQ8GSfUJ05KBu_bjlTghCvqGfoBQAxJSZJtmK71RNZ9zznDiwhJA0tGr1iZuAlsv3k_HRPbSuxPO1-XNWmyL9-66d05h7evurmLWnX3w&#39;, &#39;q&#39;: &#39;66RGuDf9nqDBb1PNQy7EDldwDYdIU-1TzjcEjfBktI0powazWPS9d8DsnxRuL0IdEmS4QyZoNx7UnUjr7si4yDuzYkwo6DRsjWMkTjnSbzwd-2d55kU68qmloWc5t1fTWGslEVbDGX05bak2JfCqW87sycxfAFHANTwnIfTEbrVFiNb8FnRBA5dRGp-dyH6nSMzV5-V0d-CjJnil_TNwx6cOVJQgT40gJl-15jwpiHBGmTKUghHwspxVrrwH6sGr-eMfF2AaJplXbJCu1G_q494XGLwJvV_q6uTSTC6aU-eKlOwRJYFgSmkbHAuxdLfAmYHzjgMvoLQjE4tdJwRdxw&#39;, &#39;dp&#39;: &#39;DKx8sPomyz94sbnhhUJAJPVYMG5lDCwaERQF7GEC8rHjftwJb1wUaKGUurgWEwjadGfzTjzH3vrKDhrQaKEspQcvouMKQZF59PQ1MpRHSTq49QsbB4ON5gDl-e2Ap6sA8hVKKaiWVjtk3QQoT1n10etsEaCNjU6_lz5nRMTb51p_XFxOx0pGy4jIDsr8jW0mVSNaZMHtQ8FUnhcmMQ-eiAZu8DtVVIUMnESH5Ll5JqPlepwjOx5oEUBUvVskNQgqD0e7Y7o2CajkECnZ5af8viZvUppmNsvNHkE4oYWioQ6EKDGW8UHEcMj97eE-oggYUIEDmCzT9jf5oVxEWnnFww&#39;, &#39;dq&#39;: &#39;YSmgm29C3Xitqgjk91G-N6eoJXvlv-15A-u9rgU0kRov0-_8Xa60vT9IkiOrd0MMl7v-GnoouKm2w5AA8LnFL5MmWV7L80tCg14g5zyCX6lrN3GoWuGq98op6I6Wxtmo5KlxZF_hHI588pG2KRi-NhLxohfqCEitN4YxIJg7suZ94Hm9Akk3UZLAN3kfZz-KHMORZAhB6PgwbbmLwAbI9xoUF53oYMTxP8FxUJj4CzE4ewzXHXbmR8-cqOsRXKQ1FFmpRUs0HTxXRwW1gRUQxpqZ7XIDlhmJ1Qc7C3yf1_7-Ln_UZiGdobELI5pStqzZ9rIVyjXYGqyMVg-9_kuXmw&#39;, &#39;qi&#39;: &#39;HpqAlt1xp_to2iVqIfXh-CulsUgLupespF1lKdpzqLkApD1JVjxXm3dItI6wGewMgABdpE6WoiTqE-gyuMlgws-1vO6RnNpeT43p3pJfzKWaaC3v4agk1_xR6BZag2-dHPNBYED0nidS9HCZH7VsxbhIZ71vio7MGJbRJieDcF0Xpn5bZ5XBhbXvgo7tIySsIZ8U7DGs3PnDkDujJY1_11YMtUPW_zJmE1OJvoE3mroBoRwF2pjASmk3_WMmAyko79LoUCPWn-HI4dtjMV5YuUJ7S1OHrR7QoAWHThSCmc_Br5XHvMllcDjcvppFGfTNRNaADZ-eeygyA-Gxe6Hahg&#39;, &#39;alg&#39;: &#39;RS256&#39;}</span>
<span class="n">ec_jwk_ES512</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">alg</span><span class="o">=</span><span class="s2">&quot;ES256&quot;</span><span class="p">)</span>
<span class="c1"># {&#39;kty&#39;: &#39;EC&#39;, &#39;crv&#39;: &#39;P-256&#39;, &#39;x&#39;: &#39;vYXg2w4d7qzhFl2BOleEfXTiUGjar9XZdNzL6WtQapA&#39;, &#39;y&#39;: &#39;QGfFxR3rOCPM4PXM6GgwwcEYHm42S-SYYRCWvbMIyko&#39;, &#39;d&#39;: &#39;1E3PnLV9zAGbV8axbNm3kVykE-xhJbueYkIVcLC4t_g&#39;, &#39;alg&#39;: &#39;ES256&#39;}</span>
<span class="n">oct_jwk_HS256</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">alg</span><span class="o">=</span><span class="s2">&quot;HS256&quot;</span><span class="p">)</span>
<span class="c1"># {&#39;kty&#39;: &#39;oct&#39;, &#39;k&#39;: &#39;EM4Yf0JLy5a6MoF0PIVhE51R4i-sPGXfiBg7Gyd7YzA&#39;, &#39;alg&#39;: &#39;HS256&#39;}</span>

<span class="c1"># a few examples without specifying an alg, but passing a key type instead:</span>
<span class="n">rsa_jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">kty</span><span class="o">=</span><span class="s2">&quot;RSA&quot;</span><span class="p">)</span>
<span class="n">oct_jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">kty</span><span class="o">=</span><span class="s2">&quot;oct&quot;</span><span class="p">)</span>

<span class="c1"># you may combine both if needed:</span>
<span class="n">rsa_jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">kty</span><span class="o">=</span><span class="s2">&quot;RSA&quot;</span><span class="p">,</span> <span class="n">alg</span><span class="o">=</span><span class="s2">&quot;RS256&quot;</span><span class="p">)</span>
<span class="c1"># a ValueError is raised if kty and alg are inconsistent:</span>
<span class="n">rsa_jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">kty</span><span class="o">=</span><span class="s2">&quot;EC&quot;</span><span class="p">,</span> <span class="n">alg</span><span class="o">=</span><span class="s2">&quot;RS256&quot;</span><span class="p">)</span>
<span class="c1"># ValueError: Incompatible `alg=&#39;RS256&#39;` and `kty=&#39;EC&#39;` parameters. `alg=&#39;RS256&#39;` points to `kty=&#39;RSA&#39;`.</span>
</code></pre></div></td></tr></table></div>
<p>You can include additional parameters such as "use" or "key_ops", or custom parameters which will be included in the
generated key:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="n">jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">alg</span><span class="o">=</span><span class="s2">&quot;ES256&quot;</span><span class="p">,</span> <span class="n">use</span><span class="o">=</span><span class="s2">&quot;sig&quot;</span><span class="p">,</span> <span class="n">custom_param</span><span class="o">=</span><span class="s2">&quot;custom_value&quot;</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">jwk</span><span class="o">.</span><span class="n">use</span> <span class="o">==</span> <span class="s2">&quot;sig&quot;</span>
<span class="k">assert</span> <span class="n">jwk</span><span class="o">.</span><span class="n">custom_param</span> <span class="o">==</span> <span class="s2">&quot;custom_value&quot;</span>
</code></pre></div></td></tr></table></div>
<p>For keys with a variable key size (such as RSA or oct), you may specify the key size:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="n">jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">kty</span><span class="o">=</span><span class="s2">&quot;oct&quot;</span><span class="p">,</span> <span class="n">key_size</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><code>jwskate</code> will warn you if the key size you specify is insufficient for the alg you are trying to use, or will raise an
exception if it is not the mandatory key size for the alg:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="n">Jwk</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">alg</span><span class="o">=</span><span class="s2">&quot;HS256&quot;</span><span class="p">,</span> <span class="n">key_size</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="c1"># UserWarning: Symmetric keys to use with HS256 should be at least 256 bits in order to make the key at least as hard to brute-force as the signature. You requested a key size of 40 bits.</span>

<span class="n">Jwk</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">alg</span><span class="o">=</span><span class="s2">&quot;A128KW&quot;</span><span class="p">,</span> <span class="n">key_size</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="c1"># ValueError: Key for A128KW must be exactly 128 bits. You should remove the `key_size` parameter to generate a key of the appropriate length.</span>
</code></pre></div></td></tr></table></div>
<p>Note that keys generated by jwskate are always private. You can get the matching public key as described below.</p>
<h3 id="private-and-public-keys">Private and Public Keys<a class="headerlink" href="#private-and-public-keys" title="Permanent link">&para;</a></h3>
<p>You can check if a key is public or private with the <code>is_private</code> property:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="n">private_jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span>
        <span class="s2">&quot;crv&quot;</span><span class="p">:</span> <span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;WtjnvHG9b_IKBLn4QYTHz-AdoAiO_ork5LH1BL_5tyI&quot;</span><span class="p">,</span>
        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;C0YfOUDuCOvTCt7hAqO-f9z8_JdOnOPbfYmUk-RosHA&quot;</span><span class="p">,</span>
        <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="s2">&quot;EnGZlkoa4VUsnl72LcRRychNJ2FFknm_ph855tNuPZ8&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="k">assert</span> <span class="n">private_jwk</span><span class="o">.</span><span class="n">is_private</span>
</code></pre></div></td></tr></table></div>
<p>You can get the public key that match a given private key with the <code>public_jwk()</code> method. It returns a new <code>Jwk</code>
instance that does not contain the private parameters:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="n">private_jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span>
        <span class="s2">&quot;crv&quot;</span><span class="p">:</span> <span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;WtjnvHG9b_IKBLn4QYTHz-AdoAiO_ork5LH1BL_5tyI&quot;</span><span class="p">,</span>
        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;C0YfOUDuCOvTCt7hAqO-f9z8_JdOnOPbfYmUk-RosHA&quot;</span><span class="p">,</span>
        <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="s2">&quot;EnGZlkoa4VUsnl72LcRRychNJ2FFknm_ph855tNuPZ8&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">public_jwk</span> <span class="o">=</span> <span class="n">private_jwk</span><span class="o">.</span><span class="n">public_jwk</span><span class="p">()</span>
<span class="k">assert</span> <span class="s2">&quot;d&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">public_jwk</span>  <span class="c1"># &quot;d&quot; would contain the private key</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">public_jwk</span><span class="o">.</span><span class="n">is_private</span>
</code></pre></div></td></tr></table></div>
<p>Note that Symmetric keys are always considered private, so calling <code>.public_jwk()</code> will raise a <code>ValueError</code>. You can
know if a key is symmetric with <code>.is_symmetric</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="n">jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">kty</span><span class="o">=</span><span class="s2">&quot;oct&quot;</span><span class="p">,</span> <span class="n">key_size</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">jwk</span><span class="o">.</span><span class="n">is_symmetric</span>
<span class="k">assert</span> <span class="n">jwk</span><span class="o">.</span><span class="n">is_private</span>
</code></pre></div></td></tr></table></div>
<h3 id="dumping-keys">Dumping keys<a class="headerlink" href="#dumping-keys" title="Permanent link">&para;</a></h3>
<h4 id="to-json">to JSON<a class="headerlink" href="#to-json" title="Permanent link">&para;</a></h4>
<p><code>Jwk</code> instances are dicts, so you can serialize it to JSON in the usual ways (with Python <code>json</code> module or any other
means). You can also use the <code>to_json()</code> convenience method to serialize a <code>Jwk</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="n">jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span>
        <span class="s2">&quot;crv&quot;</span><span class="p">:</span> <span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;WtjnvHG9b_IKBLn4QYTHz-AdoAiO_ork5LH1BL_5tyI&quot;</span><span class="p">,</span>
        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;C0YfOUDuCOvTCt7hAqO-f9z8_JdOnOPbfYmUk-RosHA&quot;</span><span class="p">,</span>
        <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="s2">&quot;EnGZlkoa4VUsnl72LcRRychNJ2FFknm_ph855tNuPZ8&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">jwk</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<span class="c1"># &#39;{&quot;kty&quot;: &quot;EC&quot;, &quot;crv&quot;: &quot;P-256&quot;, &quot;x&quot;: &quot;WtjnvHG9b_IKBLn4QYTHz-AdoAiO_ork5LH1BL_5tyI&quot;, &quot;y&quot;: &quot;C0YfOUDuCOvTCt7hAqO-f9z8_JdOnOPbfYmUk-RosHA&quot;, &quot;d&quot;: &quot;EnGZlkoa4VUsnl72LcRRychNJ2FFknm_ph855tNuPZ8&quot;}&#39;</span>
</code></pre></div></td></tr></table></div>
<h4 id="to-cryptography-keys">to <code>cryptography</code> keys<a class="headerlink" href="#to-cryptography-keys" title="Permanent link">&para;</a></h4>
<p>You can access the <code>cryptography_key</code> attribute to get a <code>cryptography</code> key instance that matches a <code>Jwk</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="n">jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span>
        <span class="s2">&quot;crv&quot;</span><span class="p">:</span> <span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;WtjnvHG9b_IKBLn4QYTHz-AdoAiO_ork5LH1BL_5tyI&quot;</span><span class="p">,</span>
        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;C0YfOUDuCOvTCt7hAqO-f9z8_JdOnOPbfYmUk-RosHA&quot;</span><span class="p">,</span>
        <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="s2">&quot;EnGZlkoa4VUsnl72LcRRychNJ2FFknm_ph855tNuPZ8&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">cryptography_key</span> <span class="o">=</span> <span class="n">jwk</span><span class="o">.</span><span class="n">cryptography_key</span>
<span class="k">assert</span> <span class="p">(</span>
    <span class="nb">str</span><span class="p">(</span><span class="n">cryptography_key</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
    <span class="o">==</span> <span class="s2">&quot;&lt;class &#39;cryptography.hazmat.backends.openssl.ec._EllipticCurvePrivateKey&#39;&gt;&quot;</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="signing-and-verifying-data">Signing and verifying data<a class="headerlink" href="#signing-and-verifying-data" title="Permanent link">&para;</a></h3>
<p>You can sign arbitrary data, then validate the signature with a <code>Jwk</code> instance, using the <code>sign()</code> and <code>verify()</code>
methods:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="n">data</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Signing is easy!&quot;</span>
<span class="n">jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate_for_kty</span><span class="p">(</span><span class="s2">&quot;EC&quot;</span><span class="p">,</span> <span class="n">crv</span><span class="o">=</span><span class="s2">&quot;P-256&quot;</span><span class="p">)</span>

<span class="n">signature</span> <span class="o">=</span> <span class="n">jwk</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">alg</span><span class="o">=</span><span class="s2">&quot;ES256&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">jwk</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">signature</span><span class="p">,</span> <span class="n">alg</span><span class="o">=</span><span class="s2">&quot;ES256&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">jwk</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="sa">b</span><span class="s2">&quot;this_is_a_wrong_signature_value_12345678012345678012345678012345&quot;</span><span class="p">,</span>
    <span class="n">alg</span><span class="o">=</span><span class="s2">&quot;ES256&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="encrypting-and-decrypting-data">Encrypting and Decrypting data<a class="headerlink" href="#encrypting-and-decrypting-data" title="Permanent link">&para;</a></h3>
<p>Encryption or decryption require a symmetric key, which translates to an instance of <code>SymmetricJwk</code>, with <code>kty='oct'</code>.
You can encrypt and decrypt arbitrary data with a Jwk instance, using the <code>encrypt()</code> and <code>decrypt()</code> methods:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="n">data</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Encryption is easy!&quot;</span>
<span class="n">alg</span> <span class="o">=</span> <span class="s2">&quot;A256GCM&quot;</span>
<span class="n">jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate_for_kty</span><span class="p">(</span><span class="s2">&quot;oct&quot;</span><span class="p">,</span> <span class="n">key_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">alg</span><span class="o">=</span><span class="n">alg</span><span class="p">)</span>

<span class="n">ciphertext</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="n">tag</span> <span class="o">=</span> <span class="n">jwk</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">jwk</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">iv</span><span class="o">=</span><span class="n">iv</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span> <span class="o">==</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
<h4 id="authenticated-encryption">Authenticated encryption<a class="headerlink" href="#authenticated-encryption" title="Permanent link">&para;</a></h4>
<p>You can include Additional Authenticated Data (<code>aad</code>) in the <code>encrypt()</code> and <code>decrypt()</code> operations:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="n">data</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Authenticated Encryption is easy!&quot;</span>
<span class="n">alg</span> <span class="o">=</span> <span class="s2">&quot;A256GCM&quot;</span>
<span class="n">aad</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;This is my auth tag&quot;</span>
<span class="n">jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate_for_kty</span><span class="p">(</span><span class="s2">&quot;oct&quot;</span><span class="p">,</span> <span class="n">key_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">alg</span><span class="o">=</span><span class="n">alg</span><span class="p">)</span>

<span class="n">ciphertext</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="n">tag</span> <span class="o">=</span> <span class="n">jwk</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">aad</span><span class="o">=</span><span class="n">aad</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">jwk</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">iv</span><span class="o">=</span><span class="n">iv</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span> <span class="n">aad</span><span class="o">=</span><span class="n">aad</span><span class="p">)</span> <span class="o">==</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
<h3 id="key-management">Key Management<a class="headerlink" href="#key-management" title="Permanent link">&para;</a></h3>
<p>Encrypting/decrypting arbitrary data is never done using asymmetric keys. But it is possible to use Key Management
algorithms with asymmetric keys to encrypt/decrypt or otherwise derive symmetric keys, which in turn can be used for
encryption/decryption using symmetric encryption algorithms.</p>
<p>Some of those Key Management algorithms rely on key wrapping, where a randomly-generated symmetric key (called a Content
Encryption Key or CEK) is itself encrypted with an asymmetric algorithm. Other algorithms rely on Diffie-Hellman, where
the CEK is derived from a pair of keys: one public and the other private. Sender will use a generated private key and
the recipient public key, while the recipient will use its private key and the sender public key. On both sides, the
resulting CEK will be the same. It is also possible to use a symmetric key to encrypt the CEK with a symmetric
algorithm, which is mostly used when the recipient is the same as the sender.</p>
<p><code>jwskate</code> provides methods that make Key Management very easy. If you are the message sender, you must obtain the
recipient public key, as a <code>Jwk</code> instance. You can then use the <code>sender_key()</code> method on that instance to generate an
appropriate CEK. It needs the target encryption algorithm as parameter, and optionally the key management algorithm, if
it is not specified in the recipient public key. It will return a tuple
<code>(plaintext_message, encrypted_cek, extra_headers)</code>, with <code>plaintext_message</code> being the generated CEK (as an instance of
<code>SymmetricJwk</code>), <code>encrypted_cek</code> is the wrapped CEK value (which can be empty for Diffie-Hellman based algorithms), and
<code>extra_headers</code> a dict of extra headers that are required for the key management algorithm (for example, <code>epk</code> for
ECDH-ES based algorithms),</p>
<p>You can use <code>cleartext_cek</code> to encrypt your message with a given Encryption algorithm. You must then send
<code>encrypted_cek</code> and <code>extra_headers</code> to your recipient, along with the encrypted message, and both Key Management and
Encryption algorithms identifiers.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="n">plaintext_message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Key Management and Encryption are easy!&quot;</span>
<span class="n">rcpt_private_jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">alg</span><span class="o">=</span><span class="s2">&quot;ECDH-ES&quot;</span><span class="p">,</span> <span class="n">crv</span><span class="o">=</span><span class="s2">&quot;P-256&quot;</span><span class="p">)</span>
<span class="c1"># {&#39;kty&#39;: &#39;EC&#39;,</span>
<span class="c1"># &#39;crv&#39;: &#39;P-256&#39;,</span>
<span class="c1"># &#39;alg&#39;: &#39;ECDH-ES&#39;,</span>
<span class="c1"># &#39;x&#39;: &#39;10QvcmuPmErnHHnrnQ7kVV-Mm_jA4QUG5W9t81jAVyE&#39;,</span>
<span class="c1"># &#39;y&#39;: &#39;Vk3Y4_qH09pm8rCLl_htf321fK62qbz6jxLlk0Y3Qe4&#39;,</span>
<span class="c1"># &#39;d&#39;: &#39;Y4vvC9He6beJi3lKYdVgvvUS9zUWz_YnV0xKT90-Z5E&#39;}</span>

<span class="n">rcpt_public_jwk</span> <span class="o">=</span> <span class="n">rcpt_private_jwk</span><span class="o">.</span><span class="n">public_jwk</span><span class="p">()</span>
<span class="c1"># {&#39;kty&#39;: &#39;EC&#39;,</span>
<span class="c1"># &#39;crv&#39;: &#39;P-256&#39;,</span>
<span class="c1"># &#39;x&#39;: &#39;10QvcmuPmErnHHnrnQ7kVV-Mm_jA4QUG5W9t81jAVyE&#39;,</span>
<span class="c1"># &#39;y&#39;: &#39;Vk3Y4_qH09pm8rCLl_htf321fK62qbz6jxLlk0Y3Qe4&#39;}</span>

<span class="n">enc_alg</span> <span class="o">=</span> <span class="s2">&quot;A256GCM&quot;</span>
<span class="n">km_alg</span> <span class="o">=</span> <span class="s2">&quot;ECDH-ES&quot;</span>
<span class="n">plaintext_cek</span><span class="p">,</span> <span class="n">encrypted_cek</span><span class="p">,</span> <span class="n">extra_headers</span> <span class="o">=</span> <span class="n">rcpt_public_jwk</span><span class="o">.</span><span class="n">sender_key</span><span class="p">(</span><span class="n">enc_alg</span><span class="p">)</span>
<span class="c1"># plaintext_cek: {&#39;kty&#39;: &#39;oct&#39;, &#39;k&#39;: &#39;iUa0WAadkir02DrdapFGzPI-9q9xqP-JaU4M69euMvc&#39;}</span>
<span class="c1"># encrypted_cek: b&#39;&#39;</span>
<span class="c1"># extra_headers: {&#39;epk&#39;: {&#39;kty&#39;: &#39;EC&#39;,</span>
<span class="c1">#  &#39;crv&#39;: &#39;P-256&#39;,</span>
<span class="c1">#  &#39;x&#39;: &#39;_26Ak6hccBPzFe2t2CYwFMH8jkKm-UWajOrci9KIPfg&#39;,</span>
<span class="c1">#  &#39;y&#39;: &#39;nVXtV6YcU1IsT8qL9zAbvMrvXvhdEvMoeVfDeF-bsRs&#39;}}</span>

<span class="n">encrypted_message</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="n">tag</span> <span class="o">=</span> <span class="n">plaintext_cek</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">plaintext_message</span><span class="p">,</span> <span class="n">alg</span><span class="o">=</span><span class="n">enc_alg</span><span class="p">)</span>
<span class="c1"># encrypted_message: b&#39;\xb5J\x16\x08\x82Xp\x0f,\x0eu\xe5\xd6\xa6y\xe0J\xae\xcbu\xf8B\xbd&#39;</span>
<span class="c1"># iv: b&#39;K&quot;H\xf3@\tt\\\xc78\xc2D&#39;</span>
<span class="c1"># tag: b&#39;\xc4\xee\xcf`\xfa\\\x8e\x9dn\xc4&gt;D\xd8\x1d\x8c\x1a&#39;</span>
</code></pre></div></td></tr></table></div>
<p>On recipient side, in order to decrypt the message, you will need to obtain the same symmetric CEK that was used to
encrypt the message. That is done with <code>recipient_key()</code> on the recipient private key. You need to provide it with the
<code>encrypted_cek</code> received from the sender (possibly empty for Diffie-Hellman based algorithms), the Key Management
algorithm that is used to wrap the CEK, the Encryption algorithm that is used to encrypt/decrypt the message, and the
eventual extra headers depending on the Key Management algorithm.</p>
<p>You can then use that CEK to decrypt the received message.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwk</span>

<span class="c1"># reusing the variables from above</span>
<span class="n">enc_alg</span> <span class="o">=</span> <span class="s2">&quot;A256GCM&quot;</span>
<span class="n">km_alg</span> <span class="o">=</span> <span class="s2">&quot;ECDH-ES&quot;</span>
<span class="n">plaintext_cek</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;oct&quot;</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">:</span> <span class="s2">&quot;iUa0WAadkir02DrdapFGzPI-9q9xqP-JaU4M69euMvc&quot;</span><span class="p">}</span>
<span class="n">encrypted_cek</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
<span class="n">extra_headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;epk&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span>
        <span class="s2">&quot;crv&quot;</span><span class="p">:</span> <span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;_26Ak6hccBPzFe2t2CYwFMH8jkKm-UWajOrci9KIPfg&quot;</span><span class="p">,</span>
        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;nVXtV6YcU1IsT8qL9zAbvMrvXvhdEvMoeVfDeF-bsRs&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="n">recipient_private_jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span>
        <span class="s2">&quot;crv&quot;</span><span class="p">:</span> <span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;10QvcmuPmErnHHnrnQ7kVV-Mm_jA4QUG5W9t81jAVyE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;Vk3Y4_qH09pm8rCLl_htf321fK62qbz6jxLlk0Y3Qe4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="s2">&quot;Y4vvC9He6beJi3lKYdVgvvUS9zUWz_YnV0xKT90-Z5E&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">encrypted_message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xb5</span><span class="s2">J</span><span class="se">\x16\x08\x82</span><span class="s2">Xp</span><span class="se">\x0f</span><span class="s2">,</span><span class="se">\x0e</span><span class="s2">u</span><span class="se">\xe5\xd6\xa6</span><span class="s2">y</span><span class="se">\xe0</span><span class="s2">J</span><span class="se">\xae\xcb</span><span class="s2">u</span><span class="se">\xf8</span><span class="s2">B</span><span class="se">\xbd</span><span class="s2">&quot;</span>
<span class="n">iv</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;K&quot;H</span><span class="se">\xf3</span><span class="s1">@</span><span class="se">\t</span><span class="s1">t</span><span class="se">\\\xc7</span><span class="s1">8</span><span class="se">\xc2</span><span class="s1">D&#39;</span>
<span class="n">tag</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xc4\xee\xcf</span><span class="s2">`</span><span class="se">\xfa\\\x8e\x9d</span><span class="s2">n</span><span class="se">\xc4</span><span class="s2">&gt;D</span><span class="se">\xd8\x1d\x8c\x1a</span><span class="s2">&quot;</span>

<span class="c1"># obtain the same CEK as the sender, based on our private key, and public data provided by sender</span>
<span class="n">cek</span> <span class="o">=</span> <span class="n">recipient_private_jwk</span><span class="o">.</span><span class="n">recipient_key</span><span class="p">(</span>
    <span class="n">encrypted_cek</span><span class="p">,</span> <span class="n">enc</span><span class="o">=</span><span class="s2">&quot;A256GCM&quot;</span><span class="p">,</span> <span class="n">alg</span><span class="o">=</span><span class="s2">&quot;ECDH-ES&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">extra_headers</span>
<span class="p">)</span>
<span class="c1"># and decrypt the message with that CEK (and the IV, Auth Tag and encryption alg identifier provided by sender)</span>
<span class="n">plaintext_message</span> <span class="o">=</span> <span class="n">cek</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted_message</span><span class="p">,</span> <span class="n">iv</span><span class="o">=</span><span class="n">iv</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span> <span class="n">alg</span><span class="o">=</span><span class="n">enc_alg</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">plaintext_message</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;Key Management and Encryption are easy!&quot;</span>
</code></pre></div></td></tr></table></div>
<h2 id="jws">JWS<a class="headerlink" href="#jws" title="Permanent link">&para;</a></h2>
<p>The <code>JwsCompact</code> class represents a syntactically valid JWS token in compact representation.</p>
<h3 id="parsing-tokens">Parsing tokens<a class="headerlink" href="#parsing-tokens" title="Permanent link">&para;</a></h3>
<p>To parse an existing Jws token and access its content (without validating the signature yet), you simply need to create
an instance of <code>JwsCompact</code> with the serialized token as value:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">JwsCompact</span>

<span class="n">jws</span> <span class="o">=</span> <span class="n">JwsCompact</span><span class="p">(</span>
    <span class="s2">&quot;eyJhbGciOiJSUzI1NiIsImtpZCI6IkpXSy1BQkNEIn0.&quot;</span>
    <span class="s2">&quot;SGVsbG8gV29ybGQh.&quot;</span>
    <span class="s2">&quot;1eucS9ZaTnAJyfVNhxLJ_phFN1rexm0l-nIXWBjUImdS29z55BuxH6NjGpltSXKrgYxYQxqGCs&quot;</span>
    <span class="s2">&quot;GIxlSVoIEhKVdhE1Vd9NPJRyw7I4zBRdwVvcqMRODMqDxCiqbDQ_5bI5jAqFEJAFCXZo2T4ixl&quot;</span>
    <span class="s2">&quot;xs-2eXtmSEp6vX51Tg1pvicM5_YrKfS8Jn3lt9xW5RaNKUJ94KVLlov_IncFsh2bg5jdo1SEoU&quot;</span>
    <span class="s2">&quot;xlB2II0JdlfCsgHohJd58eWjFToeNtH1eiXGeZOHblMLz5a5AhY8jY3C424-tggj6BK6fwpedd&quot;</span>
    <span class="s2">&quot;dFD3mtFFTNw6KT-2EgTeOlEA09pQqW5hosCj2duAlR-FQQ&quot;</span>
<span class="p">)</span>

<span class="n">jws</span><span class="o">.</span><span class="n">payload</span>
<span class="c1"># b&#39;Hello World!&#39;</span>
<span class="n">jws</span><span class="o">.</span><span class="n">headers</span>
<span class="c1"># {&#39;alg&#39;: &#39;RS256&#39;, &#39;kid&#39;: &#39;JWK-ABCD&#39;}</span>
<span class="n">jws</span><span class="o">.</span><span class="n">alg</span>
<span class="c1"># &#39;RS256&#39;</span>
<span class="n">jws</span><span class="o">.</span><span class="n">kid</span>
<span class="c1"># &#39;JWK-ABCD&#39;</span>
<span class="n">jws</span><span class="o">.</span><span class="n">signature</span>
<span class="c1"># &#39;\xd5\xeb\x9cK\xd6ZNp\t\xc9\xf5M\x87\x12\xc9\xfe\x98E7Z\xde\xc6m%\xfar\x17X\x18\xd4&quot;gR\xdb\xdc\xf9\xe4\x1b\xb1\x1f\xa3c\x1a\x99mIr\xab\x81\x8cXC\x1a\x86\n\xc1\x88\xc6T\x95\xa0\x81!)Wa\x13U]\xf4\xd3\xc9G,;#\x8c\xc1E\xdc\x15\xbd\xca\x8cD\xe0\xcc\xa8&lt;B\x8a\xa6\xc3C\xfe[#\x98\xc0\xa8Q\t\x00P\x97f\x8d\x93\xe2,e\xc6\xcf\xb6y{fHJz\xbd~uN\ri\xbe\&#39;\x0c\xe7\xf6+)\xf4\xbc&amp;}\xe5\xb7\xdcV\xe5\x16\x8d)B}\xe0\xa5K\x96\x8b\xff&quot;w\x05\xb2\x1d\x9b\x83\x98\xdd\xa3T\x84\xa1Le\x07b\x08\xd0\x97e|+ \x1e\x88Iw\x9f\x1eZ1S\xa1\xe3m\x1fW\xa2\\g\x998v\xe50\xbc\xf9k\x90!c\xc8\xd8\xdc.6\xe3\xeb`\x82&gt;\x81+\xa7\xf0\xa5\xe7]tP\xf7\x9a\xd1EL\xdc:)?\xb6\x12\x04\xde:Q\x00\xd3\xdaP\xa9na\xa2\xc0\xa3\xd9\xdb\x80\x95\x1f\x85A&#39;</span>
</code></pre></div></td></tr></table></div>
<h3 id="verifying-tokens">Verifying tokens<a class="headerlink" href="#verifying-tokens" title="Permanent link">&para;</a></h3>
<p>To verify a Jws signature, you need the matching public key:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">JwsCompact</span>

<span class="n">jws</span> <span class="o">=</span> <span class="n">JwsCompact</span><span class="p">(</span>
    <span class="s2">&quot;eyJhbGciOiJSUzI1NiIsImtpZCI6IkpXSy1BQkNEIn0.&quot;</span>
    <span class="s2">&quot;SGVsbG8gV29ybGQh.&quot;</span>
    <span class="s2">&quot;1eucS9ZaTnAJyfVNhxLJ_phFN1rexm0l-nIXWBjUImdS29z55BuxH6NjGpltSXKrgYxYQxqGCs&quot;</span>
    <span class="s2">&quot;GIxlSVoIEhKVdhE1Vd9NPJRyw7I4zBRdwVvcqMRODMqDxCiqbDQ_5bI5jAqFEJAFCXZo2T4ixl&quot;</span>
    <span class="s2">&quot;xs-2eXtmSEp6vX51Tg1pvicM5_YrKfS8Jn3lt9xW5RaNKUJ94KVLlov_IncFsh2bg5jdo1SEoU&quot;</span>
    <span class="s2">&quot;xlB2II0JdlfCsgHohJd58eWjFToeNtH1eiXGeZOHblMLz5a5AhY8jY3C424-tggj6BK6fwpedd&quot;</span>
    <span class="s2">&quot;dFD3mtFFTNw6KT-2EgTeOlEA09pQqW5hosCj2duAlR-FQQ&quot;</span>
<span class="p">)</span>
<span class="n">public_jwk</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;RSA&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kid&quot;</span><span class="p">:</span> <span class="s2">&quot;JWK-ABCD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;alg&quot;</span><span class="p">:</span> <span class="s2">&quot;RS256&quot;</span><span class="p">,</span>
    <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="s2">&quot;2jgK-5aws3_fjllgnAacPkwjbz3RCeAHni1pcHvReuTgk9qEiTmXWJiSS_F20VeI1zEwFM36e836ROCyOQ8cjjaPWpdzCajWC0koY7X8MPhZbdoSptOmDBseRCyYqmeMCp8mTTOD6Cs43SiIYSMNlPuio89qjf_4u32eVF_5YqOGtwfzC4p2NUPPCxpljYpAcf2BBG1tRX1mY4WP_8zwmx3ZH7Sy0V_fXI46tzDqfRXdMhHW7ARJAnEr_EJhlMgUaM7FUQKUNpi1ZdeeLxYv44eRx9-Roy5zTG1b0yRuaKaAG3559572quOcxISZzK5Iy7BhE7zxVa9jabEl-Y1Daw&quot;</span><span class="p">,</span>
    <span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="s2">&quot;AQAB&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="k">if</span> <span class="n">jws</span><span class="o">.</span><span class="n">verify_signature</span><span class="p">(</span><span class="n">public_jwk</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Signature is verified.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Signature verification failed!&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="signing-tokens">Signing tokens<a class="headerlink" href="#signing-tokens" title="Permanent link">&para;</a></h3>
<p>To sign a Jws, you need its payload, the private key and alg to sign with, and provide those to <code>JwsCompact.sign()</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">JwsCompact</span>

<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Hello World!&quot;</span>
<span class="n">private_jwk</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;RSA&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kid&quot;</span><span class="p">:</span> <span class="s2">&quot;JWK-ABCD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;alg&quot;</span><span class="p">:</span> <span class="s2">&quot;RS256&quot;</span><span class="p">,</span>
    <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="s2">&quot;2jgK-5aws3_fjllgnAacPkwjbz3RCeAHni1pcHvReuTgk9qEiTmXWJiSS_F20VeI1zEwFM36e836ROCyOQ8cjjaPWpdzCajWC0koY7X8MPhZbdoSptOmDBseRCyYqmeMCp8mTTOD6Cs43SiIYSMNlPuio89qjf_4u32eVF_5YqOGtwfzC4p2NUPPCxpljYpAcf2BBG1tRX1mY4WP_8zwmx3ZH7Sy0V_fXI46tzDqfRXdMhHW7ARJAnEr_EJhlMgUaM7FUQKUNpi1ZdeeLxYv44eRx9-Roy5zTG1b0yRuaKaAG3559572quOcxISZzK5Iy7BhE7zxVa9jabEl-Y1Daw&quot;</span><span class="p">,</span>
    <span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="s2">&quot;AQAB&quot;</span><span class="p">,</span>
    <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="s2">&quot;XCtpsCRQ1DBBm51yqdQ88C82lEjW30Xp0cy6iVEzBKZhmPGmI1PY8gnXWQ5PMlK3sLTM6yypDNvORoNlo6YXWJYA7LGlXEIczj2DOsJmF8T9-OEwGZixvNFDcmYnwWnlA6N_CQKmR0ziQr9ZAzZMCU5Tvr7f8cRZKdAALQEwk5FYpLnEbXOBduJtY9x2kddJSCJwRaEJhx0fG_pJAO3yLUZBY20dZK8UrxDoCgB9eiZV3N4uWGt367r1MDdaxGY6l6bC1HZCHkttBuTxfSUMCgooZevdU6ThQNpFrwZNY3KoP-OksEdqMs-neecfk_AQREkubDW2VPNFnaVEa38BKQ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;p&quot;</span><span class="p">:</span> <span class="s2">&quot;8QNZGwUINpkuZi8l2ZfQzKVeOeNe3aQ7UW0wperM-63DFEJDRO1UyNC1n6yeo8_RxPZKSTlr6xZDoilQq23mopeF6O0ZmYz6E2VWJuma65V-A7tB-6xjqUXPlSkCNA6Ia8kMeCmNpKs0r0ijTBf_2y2GSsNH4EcP7XzcDEeJIh0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;q&quot;</span><span class="p">:</span> <span class="s2">&quot;58nWgg-qRorRddwKM7qhLxJnEDsnCiYhbKJrP78OfBZ-839bNRvL5D5sfjJqxcKMQidgpYZVvVNL8oDEywcC5T7kKW0HK1JUdYiX9DuI40Mv9WzXQ8B8FBjp5wV4IX6_0KgyIiyoUiKpVHBvO0YFPUYuk0Ns4H9yEws93RWwhSc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dp&quot;</span><span class="p">:</span> <span class="s2">&quot;zFsLZcaphSnzVr9pd4urhqo9MBZjbMmBZnSQCE8ECe729ymMQlh-SFv3dHF4feuLsVcn-9iNceMJ6-jeNs1T_s89wxevWixYKrQFDa-MJW83T1CrDQvJ4VCJR69i5-Let43cXdLWACcO4AVWOQIsdpquQJw-SKPYlIUHS_4n_90&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dq&quot;</span><span class="p">:</span> <span class="s2">&quot;fP79rNnhy3TlDBgDcG3-qjHUXo5nuTNi5wCXsaLInuZKw-k0OGmrBIUdYNizd744gRxXJCxTZGvdEwOaHJrFVvcZd7WSHiyh21g0CcNpSJVc8Y8mbyUIRJZC3RC3_egqbM2na4KFqvWCN0UC1wYloSuNxmCgAFj6HYb8b5NYxBU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qi&quot;</span><span class="p">:</span> <span class="s2">&quot;hxXfLYgwrfZBvZ27nrPsm6mLuoO-V2rKdOj3-YDJzf0gnVGBLl0DZbgydZ8WZmSLn2290mO_J8XY-Ss8PjLYbz3JXPDNLMJ-da3iEPKTvh6OfliM_dBxhaW8sq5afLMUR0H8NeabbWkfPz5h0W11CCBYxsyPC6CzniFYCYXfByU&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">jws</span> <span class="o">=</span> <span class="n">JwsCompact</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">jwk</span><span class="o">=</span><span class="n">private_jwk</span><span class="p">,</span> <span class="n">alg</span><span class="o">=</span><span class="s2">&quot;RS256&quot;</span><span class="p">)</span>
<span class="nb">str</span><span class="p">(</span><span class="n">jws</span><span class="p">)</span>
<span class="c1"># &#39;eyJhbGciOiJSUzI1NiIsImtpZCI6IkpXSy1BQkNEIn0.SGVsbG8gV29ybGQh.1eucS9ZaTnAJyfVNhxLJ_phFN1rexm0l-nIXWBjUImdS29z55BuxH6NjGpltSXKrgYxYQxqGCsGIxlSVoIEhKVdhE1Vd9NPJRyw7I4zBRdwVvcqMRODMqDxCiqbDQ_5bI5jAqFEJAFCXZo2T4ixlxs-2eXtmSEp6vX51Tg1pvicM5_YrKfS8Jn3lt9xW5RaNKUJ94KVLlov_IncFsh2bg5jdo1SEoUxlB2II0JdlfCsgHohJd58eWjFToeNtH1eiXGeZOHblMLz5a5AhY8jY3C424-tggj6BK6fwpedddFD3mtFFTNw6KT-2EgTeOlEA09pQqW5hosCj2duAlR-FQQ&#39;</span>
</code></pre></div></td></tr></table></div>
<h2 id="jwe">JWE<a class="headerlink" href="#jwe" title="Permanent link">&para;</a></h2>
<p>The <code>JweCompact</code> class represents a syntactically valid JWE token.</p>
<h3 id="parsing-and-decrypting-jwe-tokens">Parsing and decrypting JWE tokens<a class="headerlink" href="#parsing-and-decrypting-jwe-tokens" title="Permanent link">&para;</a></h3>
<p>Provide the serialized token value to <code>JweCompact</code>, then use <code>.decrypt()</code> with the private key to decrypt the token
payload:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">JweCompact</span>

<span class="n">jwe</span> <span class="o">=</span> <span class="n">JweCompact</span><span class="p">(</span>
    <span class="s2">&quot;eyJhbGciOiJSU0EtT0FFUCIsImVuYyI6IkEyNTZHQ00ifQ.&quot;</span>
    <span class="s2">&quot;OKOawDo13gRp2ojaHV7LFpZcgV7T6DVZKTyKOMTYUmKoTCVJRgckCL9kiMT03JGe&quot;</span>
    <span class="s2">&quot;ipsEdY3mx_etLbbWSrFr05kLzcSr4qKAq7YN7e9jwQRb23nfa6c9d-StnImGyFDb&quot;</span>
    <span class="s2">&quot;Sv04uVuxIp5Zms1gNxKKK2Da14B8S4rzVRltdYwam_lDp5XnZAYpQdb76FdIKLaV&quot;</span>
    <span class="s2">&quot;mqgfwX7XWRxv2322i-vDxRfqNzo_tETKzpVLzfiwQyeyPGLBIO56YJ7eObdv0je8&quot;</span>
    <span class="s2">&quot;1860ppamavo35UgoRdbYaBcoh9QcfylQr66oc6vFWXRcZ_ZT2LawVCWTIy3brGPi&quot;</span>
    <span class="s2">&quot;6UklfCpIMfIjf7iGdXKHzg.&quot;</span>
    <span class="s2">&quot;48V1_ALb6US04U3b.&quot;</span>
    <span class="s2">&quot;5eym8TW_c8SuK0ltJ3rpYIzOeDQz7TALvtu6UG9oMo4vpzs9tX_EFShS8iB7j6ji&quot;</span>
    <span class="s2">&quot;SdiwkIr3ajwQzaBtQD_A.&quot;</span>
    <span class="s2">&quot;XFBoMYUZodetZdvTiFvSkQ&quot;</span>
<span class="p">)</span>

<span class="c1"># all &#39;raw&#39; attributes are accessible:</span>
<span class="n">jwe</span><span class="o">.</span><span class="n">headers</span>
<span class="c1"># {&#39;alg&#39;: &#39;RSA-OAEP&#39;, &#39;enc&#39;: &#39;A256GCM&#39;}</span>
<span class="n">jwe</span><span class="o">.</span><span class="n">alg</span>
<span class="c1"># &#39;RSA-OAEP&#39;</span>
<span class="n">jwe</span><span class="o">.</span><span class="n">enc</span>
<span class="c1"># &#39;A256GCM&#39;</span>
<span class="n">jwe</span><span class="o">.</span><span class="n">ciphertext</span>
<span class="c1"># b&quot;\xe5\xec\xa6\xf15\xbfs\xc4\xae+Im&#39;z\xe9`\x8c\xcex43\xed0\x0b\xbe\xdb\xbaPoh2\x8e/\xa7;=\xb5\x7f\xc4\x15(R\xf2 {\x8f\xa8\xe2I\xd8\xb0\x90\x8a\xf7j&lt;\x10\xcd\xa0m@?\xc0&quot;</span>
<span class="n">jwe</span><span class="o">.</span><span class="n">wrapped_cek</span>
<span class="c1"># b&#39;8\xa3\x9a\xc0:5\xde\x04i\xda\x88\xda\x1d^\xcb\x16\x96\\\x81^\xd3\xe85Y)&lt;\x8a8\xc4\xd8Rb\xa8L%IF\x07$\x08\xbfd\x88\xc4\xf4\xdc\x91\x9e\x8a\x9b\x04u\x8d\xe6\xc7\xf7\xad-\xb6\xd6J\xb1k\xd3\x99\x0b\xcd\xc4\xab\xe2\xa2\x80\xab\xb6\r\xed\xefc\xc1\x04[\xdby\xdfk\xa7=w\xe4\xad\x9c\x89\x86\xc8P\xdbJ\xfd8\xb9[\xb1&quot;\x9eY\x9a\xcd`7\x12\x8a+`\xda\xd7\x80|K\x8a\xf3U\x19mu\x8c\x1a\x9b\xf9C\xa7\x95\xe7d\x06)A\xd6\xfb\xe8WH(\xb6\x95\x9a\xa8\x1f\xc1~\xd7Y\x1co\xdb}\xb6\x8b\xeb\xc3\xc5\x17\xea7:?\xb4D\xca\xce\x95K\xcd\xf8\xb0C\&#39;\xb2&lt;b\xc1 \xeez`\x9e\xde9\xb7o\xd27\xbc\xd7\xce\xb4\xa6\x96\xa6j\xfa7\xe5H(E\xd6\xd8h\x17(\x87\xd4\x1c\x7f)P\xaf\xae\xa8s\xab\xc5Yt\\g\xf6S\xd8\xb6\xb0T%\x93#-\xdb\xacc\xe2\xe9I%|*H1\xf2#\x7f\xb8\x86ur\x87\xce&#39;</span>
<span class="n">jwe</span><span class="o">.</span><span class="n">initialization_vector</span>
<span class="c1"># b&#39;\xe3\xc5u\xfc\x02\xdb\xe9D\xb4\xe1M\xdb&#39;</span>
<span class="n">jwe</span><span class="o">.</span><span class="n">authentication_tag</span>
<span class="c1"># b&#39;\\Ph1\x85\x19\xa1\xd7\xade\xdb\xd3\x88[\xd2\x91&#39;</span>


<span class="n">private_jwk</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;RSA&quot;</span><span class="p">,</span>
    <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="s2">&quot;oahUIoWw0K0usKNuOR6H4wkf4oBUXHTxRvgb48E-BVvxkeDNjbC4he8rUW&quot;</span>
    <span class="s2">&quot;cJoZmds2h7M70imEVhRU5djINXtqllXI4DFqcI1DgjT9LewND8MW2Krf3S&quot;</span>
    <span class="s2">&quot;psk_ZkoFnilakGygTwpZ3uesH-PFABNIUYpOiN15dsQRkgr0vEhxN92i2a&quot;</span>
    <span class="s2">&quot;sbOenSZeyaxziK72UwxrrKoExv6kc5twXTq4h-QChLOln0_mtUZwfsRaMS&quot;</span>
    <span class="s2">&quot;tPs6mS6XrgxnxbWhojf663tuEQueGC-FCMfra36C9knDFGzKsNa7LZK2dj&quot;</span>
    <span class="s2">&quot;YgyD3JR_MB_4NUJW_TqOQtwHYbxevoJArm-L5StowjzGy-_bq6Gw&quot;</span><span class="p">,</span>
    <span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="s2">&quot;AQAB&quot;</span><span class="p">,</span>
    <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="s2">&quot;kLdtIj6GbDks_ApCSTYQtelcNttlKiOyPzMrXHeI-yk1F7-kpDxY4-WY5N&quot;</span>
    <span class="s2">&quot;WV5KntaEeXS1j82E375xxhWMHXyvjYecPT9fpwR_M9gV8n9Hrh2anTpTD9&quot;</span>
    <span class="s2">&quot;3Dt62ypW3yDsJzBnTnrYu1iwWRgBKrEYY46qAZIrA2xAwnm2X7uGR1hghk&quot;</span>
    <span class="s2">&quot;qDp0Vqj3kbSCz1XyfCs6_LehBwtxHIyh8Ripy40p24moOAbgxVw3rxT_vl&quot;</span>
    <span class="s2">&quot;t3UVe4WO3JkJOzlpUf-KTVI2Ptgm-dARxTEtE-id-4OJr0h-K-VFs3VSnd&quot;</span>
    <span class="s2">&quot;VTIznSxfyrj8ILL6MG_Uv8YAu7VILSB3lOW085-4qE3DzgrTjgyQ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;p&quot;</span><span class="p">:</span> <span class="s2">&quot;1r52Xk46c-LsfB5P442p7atdPUrxQSy4mti_tZI3Mgf2EuFVbUoDBvaRQ-&quot;</span>
    <span class="s2">&quot;SWxkbkmoEzL7JXroSBjSrK3YIQgYdMgyAEPTPjXv_hI2_1eTSPVZfzL0lf&quot;</span>
    <span class="s2">&quot;fNn03IXqWF5MDFuoUYE0hzb2vhrlN_rKrbfDIwUbTrjjgieRbwC6Cl0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;q&quot;</span><span class="p">:</span> <span class="s2">&quot;wLb35x7hmQWZsWJmB_vle87ihgZ19S8lBEROLIsZG4ayZVe9Hi9gDVCOBm&quot;</span>
    <span class="s2">&quot;UDdaDYVTSNx_8Fyw1YYa9XGrGnDew00J28cRUoeBB_jKI1oma0Orv1T9aX&quot;</span>
    <span class="s2">&quot;IWxKwd4gvxFImOWr3QRL9KEBRzk2RatUBnmDZJTIAfwTs0g68UZHvtc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dp&quot;</span><span class="p">:</span> <span class="s2">&quot;ZK-YwE7diUh0qR1tR7w8WHtolDx3MZ_OTowiFvgfeQ3SiresXjm9gZ5KL&quot;</span>
    <span class="s2">&quot;hMXvo-uz-KUJWDxS5pFQ_M0evdo1dKiRTjVw_x4NyqyXPM5nULPkcpU827&quot;</span>
    <span class="s2">&quot;rnpZzAJKpdhWAgqrXGKAECQH0Xt4taznjnd_zVpAmZZq60WPMBMfKcuE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dq&quot;</span><span class="p">:</span> <span class="s2">&quot;Dq0gfgJ1DdFGXiLvQEZnuKEN0UUmsJBxkjydc3j4ZYdBiMRAy86x0vHCj&quot;</span>
    <span class="s2">&quot;ywcMlYYg4yoC4YZa9hNVcsjqA3FeiL19rk8g6Qn29Tt0cj8qqyFpz9vNDB&quot;</span>
    <span class="s2">&quot;UfCAiJVeESOjJDZPYHdHY8v1b-o-Z2X5tvLx-TCekf7oxyeKDUqKWjis&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qi&quot;</span><span class="p">:</span> <span class="s2">&quot;VIMpMYbPf47dT1w_zDUXfPimsSegnMOA1zTaX7aGk_8urY6R8-ZW1FxU7&quot;</span>
    <span class="s2">&quot;AlWAyLWybqq6t16VFd7hQd0y6flUK4SlOydB61gwanOsXGOAOv82cHq0E3&quot;</span>
    <span class="s2">&quot;eL4HrtZkUuKvnPrMnsUUFlfUdybVzxyjz9JF_XyaY14ardLSjf4L_FNY&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">payload</span> <span class="o">=</span> <span class="n">jwe</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">private_jwk</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">payload</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;The true sign of intelligence is not knowledge but imagination.&quot;</span>

<span class="c1"># you can also decrypt only the CEK (returned as SymmetricJwk instance):</span>
<span class="n">cek</span> <span class="o">=</span> <span class="n">jwe</span><span class="o">.</span><span class="n">unwrap_cek</span><span class="p">(</span><span class="n">private_jwk</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">cek</span> <span class="o">==</span> <span class="p">{</span><span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;oct&quot;</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">:</span> <span class="s2">&quot;saH0gFSP4XM_tAP_a5rU9ooHbltwLiJpL4LLLnrqQPw&quot;</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="encrypting-jwe-tokens">Encrypting JWE tokens<a class="headerlink" href="#encrypting-jwe-tokens" title="Permanent link">&para;</a></h3>
<p>To encrypt a JWE token, use <code>JweCompact.encrypt()</code> with the plaintext, public key, key management alg (<code>alg</code>) and
encryption alg (<code>enc</code>):</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">JweCompact</span><span class="p">,</span> <span class="n">Jwk</span>

<span class="n">plaintext</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Encrypting JWE is easy!&quot;</span>
<span class="n">private_jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate_for_kty</span><span class="p">(</span><span class="s2">&quot;EC&quot;</span><span class="p">)</span>
<span class="n">public_jwk</span> <span class="o">=</span> <span class="n">private_jwk</span><span class="o">.</span><span class="n">public_jwk</span><span class="p">()</span>

<span class="n">jwe</span> <span class="o">=</span> <span class="n">JweCompact</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">public_jwk</span><span class="p">,</span> <span class="n">alg</span><span class="o">=</span><span class="s2">&quot;ECDH-ES+A128KW&quot;</span><span class="p">,</span> <span class="n">enc</span><span class="o">=</span><span class="s2">&quot;A128GCM&quot;</span><span class="p">)</span>
<span class="nb">str</span><span class="p">(</span><span class="n">jwe</span><span class="p">)</span>
<span class="c1"># &#39;eyJlcGsiOnsia3R5IjoiRUMiLCJjcnYiOiJQLTI1NiIsIngiOiI3a2VIdGxXdnVQQWVfYzR3d1hsNXFBZENHYzNKSk9KX0c5WThWU29Cc0tBIiwieSI6ImlyVFpRVzFlckZUSGd4WG1nUVdpcTVBYXdNOXNtamxybE96X2RTMmpld1kifSwiYWxnIjoiRUNESC1FUytBMTI4S1ciLCJlbmMiOiJBMTI4R0NNIn0.s7iUWLT2TG_kRnxuRvMxL5lY1oVRRVlI.kQaT5CM0HYfdwQ9H.49Trq2lpEtOEk8u_HP20TuJ80xpkqK8.RsQMBzvLj5i9bk4eew21gg&#39;</span>
</code></pre></div></td></tr></table></div>
<h2 id="jwt">JWT<a class="headerlink" href="#jwt" title="Permanent link">&para;</a></h2>
<p>JWT tokens are JWS tokens which contain a JSON object as payload. Some attributes of this JSON object are standardised
to represent the token issuer, audience, and lifetime.</p>
<p>The <code>Jwt</code> class and its subclasses represent a syntactically valid Jwt token. It then allows to access the JWT content
and verify its signature.</p>
<p>Note that a JWT token can optionally be encrypted. In that case, the signed JWT content will be the plaintext of a JWE
token. Decrypting that JWE can then be achieved with the <code>JweCompact</code> class, then this plaintext can be manipulated with
the <code>Jwt</code> class.</p>
<h3 id="parsing-jwt-tokens">Parsing JWT tokens<a class="headerlink" href="#parsing-jwt-tokens" title="Permanent link">&para;</a></h3>
<p>To parse an existing JWT token, simply initialize a <code>Jwt</code> with the token value as parameter. An instance of <code>Jwt</code>
exposes all the JWT attributes, and a <code>verify_signature()</code> method just like <code>JwsCompact()</code>. Claims can be accessed
either:</p>
<ul>
<li>with the <code>claims</code> attribute, which is a dict of the parsed JSON content</li>
<li>with subscription: <code>jwt['attribute']</code> does a key lookup inside the <code>claims</code> dict, just like <code>jwt.claims['attribute']</code></li>
<li>with attribute access: <code>jwt.attribute</code> does the same as <code>jwt.claims['attribute']</code>. Note that attribute names
  containing special characters are not accessible this way due to Python syntax for attribute names.</li>
<li>for standardised attributes, with a dedicated special attribute, which will parse and validate the attribute value.
  Example: <code>jwt.expires_at</code> returns a <code>datetime</code> initialised from the <code>exp</code> claim.</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwt</span>

<span class="n">jwt</span> <span class="o">=</span> <span class="n">Jwt</span><span class="p">(</span>
    <span class="s2">&quot;eyJhbGciOiJSUzI1NiIsImtpZCI6Im15X2tleSJ9.eyJhY3IiOiIyIiwiYW1yIjpbInB3ZCIsIm90cCJdLCJhdWQiOiJjbGllbnRfaWQiLCJhdXRoX3RpbWUiOjE2MjkyMDQ1NjAsImV4cCI6MTYyOTIwNDYyMCwiaWF0IjoxNjI5MjA0NTYwLCJpc3MiOiJodHRwczovL215YXMubG9jYWwiLCJub25jZSI6Im5vbmNlIiwic3ViIjoiMTIzNDU2In0.wUfjMyjlOSdvbFGFP8O8wGcNBK7akeyOUBMvYcNZclFUtokOyxhLUPxmo1THo1DV1BHUVd6AWfeKUnyTxl_8-G3E_a9u5wJfDyfghPDhCmfkYARvqQnnV_3aIbfTfUBC4f0bHr08d_q0fED88RLu77wESIPCVqQYy2bk4FLucc63yGBvaCskqzthZ85DbBJYWLlR8qBUk_NA8bWATYEtjwTrxoZe-uA-vB6NwUv1h8DKRsDF-9HSVHeWXXAeoG9UW7zgxoY3KbDIVzemvGzs2R9OgDBRRafBBVeAkDV6CdbdMNJDmHzcjase5jX6LE-3YCy7c7AMM1uWRCnK3f-azA&quot;</span>
<span class="p">)</span>

<span class="n">jwt</span><span class="o">.</span><span class="n">claims</span>
<span class="c1"># {&#39;acr&#39;: &#39;2&#39;,</span>
<span class="c1">#  &#39;amr&#39;: [&#39;pwd&#39;, &#39;otp&#39;],</span>
<span class="c1">#  &#39;aud&#39;: &#39;client_id&#39;,</span>
<span class="c1">#  &#39;auth_time&#39;: 1629204560,</span>
<span class="c1">#  &#39;exp&#39;: 1629204620,</span>
<span class="c1">#  &#39;iat&#39;: 1629204560,</span>
<span class="c1">#  &#39;iss&#39;: &#39;https://myas.local&#39;,</span>
<span class="c1">#  &#39;nonce&#39;: &#39;nonce&#39;,</span>
<span class="c1">#  &#39;sub&#39;: &#39;123456&#39;}</span>

<span class="c1"># example claim access via subscription:</span>
<span class="n">jwt</span><span class="p">[</span><span class="s2">&quot;acr&quot;</span><span class="p">]</span>
<span class="c1"># &#39;2&#39;</span>

<span class="c1"># example claim access via attribute:</span>
<span class="n">jwt</span><span class="o">.</span><span class="n">sub</span>
<span class="c1"># &#39;123456&#39;</span>

<span class="c1"># example special claim access:</span>
<span class="n">jwt</span><span class="o">.</span><span class="n">expires_at</span>
<span class="c1"># datetime.datetime(2021, 8, 17, 12, 50, 20, tzinfo=datetime.timezone.utc)</span>

<span class="c1"># the raw &#39;exp&#39; value is still accessible with the other means:</span>
<span class="n">jwt</span><span class="p">[</span><span class="s2">&quot;exp&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">jwt</span><span class="o">.</span><span class="n">exp</span> <span class="o">==</span> <span class="mi">1629204620</span>
<span class="c1"># True</span>

<span class="c1"># other special attributes:</span>
<span class="n">jwt</span><span class="o">.</span><span class="n">audiences</span>  <span class="c1"># always return a list</span>
<span class="c1"># [&#39;client_id&#39;]</span>
<span class="n">jwt</span><span class="o">.</span><span class="n">issued_at</span>
<span class="c1"># datetime.datetime(2021, 8, 17, 12, 49, 20, tzinfo=datetime.timezone.utc)</span>
<span class="n">jwt</span><span class="o">.</span><span class="n">not_before</span>  <span class="c1"># this would be a datetime if there was a valid &#39;nbf&#39; claim in the token</span>
<span class="kc">None</span>
<span class="n">jwt</span><span class="o">.</span><span class="n">subject</span>  <span class="c1"># return the &#39;sub&#39; claim, and makes sure it is a string</span>
<span class="c1"># &#39;123456&#39;</span>
<span class="n">jwt</span><span class="o">.</span><span class="n">issuer</span>  <span class="c1"># return the &#39;iss&#39; claim, and makes sure that it is a string</span>
<span class="c1"># &#39;https://myas.local&#39;</span>


<span class="n">jwt</span><span class="o">.</span><span class="n">headers</span>
<span class="c1"># {&#39;alg&#39;: &#39;RS256&#39;, &#39;kid&#39;: &#39;my_key&#39;}</span>

<span class="n">jwt</span><span class="o">.</span><span class="n">signature</span>
<span class="c1"># b&quot;\xc1G\xe33(\xe59&#39;olQ\x85?\xc3\xbc\xc0g\r\x04\xae\xda\x91\xec\x8eP\x13/a\xc3YrQT\xb6\x89\x0e\xcb\x18KP\xfcf\xa3T\xc7\xa3P\xd5\xd4\x11\xd4U\xde\x80Y\xf7\x8aR|\x93\xc6_\xfc\xf8m\xc4\xfd\xafn\xe7\x02_\x0f&#39;\xe0\x84\xf0\xe1\ng\xe4`\x04o\xa9\t\xe7W\xfd\xda!\xb7\xd3}@B\xe1\xfd\x1b\x1e\xbd&lt;w\xfa\xb4|@\xfc\xf1\x12\xee\xef\xbc\x04H\x83\xc2V\xa4\x18\xcbf\xe4\xe0R\xeeq\xce\xb7\xc8`oh+$\xab;ag\xceCl\x12XX\xb9Q\xf2\xa0T\x93\xf3@\xf1\xb5\x80M\x81-\x8f\x04\xeb\xc6\x86^\xfa\xe0&gt;\xbc\x1e\x8d\xc1K\xf5\x87\xc0\xcaF\xc0\xc5\xfb\xd1\xd2Tw\x96]p\x1e\xa0oT[\xbc\xe0\xc6\x867)\xb0\xc8W7\xa6\xbcl\xec\xd9\x1fN\x800QE\xa7\xc1\x05W\x80\x905z\t\xd6\xdd0\xd2C\x98|\xdc\x8d\xab\x1e\xe65\xfa,O\xb7`,\xbbs\xb0\x0c3[\x96D)\xca\xdd\xff\x9a\xcc&quot;</span>

<span class="c1"># verifying the signature:</span>
<span class="k">assert</span> <span class="n">jwt</span><span class="o">.</span><span class="n">verify_signature</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;RSA&quot;</span><span class="p">,</span>
        <span class="s2">&quot;kid&quot;</span><span class="p">:</span> <span class="s2">&quot;my_key&quot;</span><span class="p">,</span>
        <span class="s2">&quot;alg&quot;</span><span class="p">:</span> <span class="s2">&quot;RS256&quot;</span><span class="p">,</span>
        <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="s2">&quot;2m4QVSHdUo2DFSbGY24cJbxE10KbgdkSCtm0YZ1q0Zmna8pJg8YhaWCJHV7D5AxQ_L1b1PK0jsdpGYWc5-Pys0FB2hyABGPxXIdg1mjxn6geHLpWzsA3MHD29oqfl0Rt7g6AFc5St3lBgJCyWtci6QYBmBkX9oIMOx9pgv4BaT6y1DdrNh27-oSMXZ0a58KwnC6jbCpdA3V3Eume-Be1Tx9lJN3j6S8ydT7CGY1Xd-sc3oB8pXfkr1_EYf0Sgb9EwOJfqlNK_kVjT3GZ-1JJMKJ6zkU7H0yXe2SKXAzfayvJaIcYrk-sYwmf-u7yioOLLvjlGjysN7SOSM8socACcw&quot;</span><span class="p">,</span>
        <span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="s2">&quot;AQAB&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># verifying expiration:</span>
<span class="k">assert</span> <span class="n">jwt</span><span class="o">.</span><span class="n">is_expired</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h3 id="validating-jwt-tokens">Validating JWT tokens<a class="headerlink" href="#validating-jwt-tokens" title="Permanent link">&para;</a></h3>
<p>To validate a JWT token, verifying the signature is usually not enough. You probably want to validate the issuer,
audience, expiration date, and other claims. To make things easier, use <code>SignedJwt.validate()</code>. It raises exceptions if
one of the check fails:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwt</span>

<span class="n">jwt</span> <span class="o">=</span> <span class="n">Jwt</span><span class="p">(</span>
    <span class="s2">&quot;eyJhbGciOiJSUzI1NiIsImtpZCI6Im15X2tleSJ9.&quot;</span>
    <span class="s2">&quot;eyJhY3IiOiIyIiwiYW1yIjpbInB3ZCIsIm90cCJdLCJhdWQiOiJjbGllbnRfaWQiLCJhdXRoX3RpbWUiOjE2MjkyMDQ1NjAsImV4cCI6MTYyOTIwNDYyMCwiaWF0IjoxNjI5MjA0NTYwLCJpc3MiOiJodHRwczovL215YXMubG9jYWwiLCJub25jZSI6Im5vbmNlIiwic3ViIjoiMTIzNDU2In0.wUfjMyjlOSdvbFGFP8O8wGcNBK7akeyOUBMvYcNZclFUtokOyxhLUPxmo1THo1DV1BHUVd6AWfeKUnyTxl_8-G3E_a9u5wJfDyfghPDhCmfkYARvqQnnV_3aIbfTfUBC4f0bHr08d_q0fED88RLu77wESIPCVqQYy2bk4FLucc63yGBvaCskqzthZ85DbBJYWLlR8qBUk_NA8bWATYEtjwTrxoZe-uA-vB6NwUv1h8DKRsDF-9HSVHeWXXAeoG9UW7zgxoY3KbDIVzemvGzs2R9OgDBRRafBBVeAkDV6CdbdMNJDmHzcjase5jX6LE-3YCy7c7AMM1uWRCnK3f-azA&quot;</span>
<span class="p">)</span>
<span class="n">jwk</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;RSA&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kid&quot;</span><span class="p">:</span> <span class="s2">&quot;my_key&quot;</span><span class="p">,</span>
    <span class="s2">&quot;alg&quot;</span><span class="p">:</span> <span class="s2">&quot;RS256&quot;</span><span class="p">,</span>
    <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="s2">&quot;2m4QVSHdUo2DFSbGY24cJbxE10KbgdkSCtm0YZ1q0Zmna8pJg8YhaWCJHV7D5AxQ_L1b1PK0jsdpGYWc5-Pys0FB2hyABGPxXIdg1mjxn6geHLpWzsA3MHD29oqfl0Rt7g6AFc5St3lBgJCyWtci6QYBmBkX9oIMOx9pgv4BaT6y1DdrNh27-oSMXZ0a58KwnC6jbCpdA3V3Eume-Be1Tx9lJN3j6S8ydT7CGY1Xd-sc3oB8pXfkr1_EYf0Sgb9EwOJfqlNK_kVjT3GZ-1JJMKJ6zkU7H0yXe2SKXAzfayvJaIcYrk-sYwmf-u7yioOLLvjlGjysN7SOSM8socACcw&quot;</span><span class="p">,</span>
    <span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="s2">&quot;AQAB&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">jwt</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">jwk</span><span class="p">,</span> <span class="n">issuer</span><span class="o">=</span><span class="s2">&quot;https://myas.local&quot;</span><span class="p">,</span> <span class="n">audience</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">)</span>
<span class="c1"># at the time you run this, it will probably raise a `jwskate.ExpiredJwt` exception</span>
</code></pre></div></td></tr></table></div>
<h3 id="signing-jwt-tokens">Signing JWT tokens<a class="headerlink" href="#signing-jwt-tokens" title="Permanent link">&para;</a></h3>
<p>To sign a set of claims into a JWT, use <code>Jwt.sign()</code>. It takes the claims (as a dict), the signing key, and the
signature alg to use (if the key doesn't have an 'alg' parameter).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwt</span><span class="p">,</span> <span class="n">Jwk</span>

<span class="n">claims</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;claim1&quot;</span><span class="p">:</span> <span class="s2">&quot;value1&quot;</span><span class="p">,</span> <span class="s2">&quot;claim2&quot;</span><span class="p">:</span> <span class="s2">&quot;value2&quot;</span><span class="p">}</span>
<span class="n">jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate_for_kty</span><span class="p">(</span><span class="s2">&quot;EC&quot;</span><span class="p">,</span> <span class="n">crv</span><span class="o">=</span><span class="s2">&quot;P-256&quot;</span><span class="p">)</span>
<span class="n">jwt</span> <span class="o">=</span> <span class="n">Jwt</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">claims</span><span class="p">,</span> <span class="n">jwk</span><span class="p">,</span> <span class="n">alg</span><span class="o">=</span><span class="s2">&quot;ES256&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">jwt</span><span class="p">)</span>
<span class="c1"># eyJhbGciOiJFUzI1NiJ9.eyJjbGFpbTEiOiJ2YWx1ZTEiLCJjbGFpbTIiOiJ2YWx1ZTIifQ.mqqXTljXQwNff0Sah88oFGBNWC9XpZxUj3WDa9-00UAyuEoL6cey-rHQNtmYgYgPRgI_HnWpRm5M4_a9qv9m0g</span>
</code></pre></div></td></tr></table></div>
<h4 id="jwt-headers">JWT headers<a class="headerlink" href="#jwt-headers" title="Permanent link">&para;</a></h4>
<p>The default header will contain the signing algorithm identifier (alg) and the JWK Key Identifier (kid), if there was
one in the used JWK. You can add additional headers by using the <code>extra_headers</code> parameter to <code>Jwt.sign()</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">jwskate</span> <span class="kn">import</span> <span class="n">Jwt</span><span class="p">,</span> <span class="n">Jwk</span>

<span class="n">claims</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;claim1&quot;</span><span class="p">:</span> <span class="s2">&quot;value1&quot;</span><span class="p">,</span> <span class="s2">&quot;claim2&quot;</span><span class="p">:</span> <span class="s2">&quot;value2&quot;</span><span class="p">}</span>
<span class="n">jwk</span> <span class="o">=</span> <span class="n">Jwk</span><span class="o">.</span><span class="n">generate_for_kty</span><span class="p">(</span><span class="s2">&quot;EC&quot;</span><span class="p">,</span> <span class="n">crv</span><span class="o">=</span><span class="s2">&quot;P-256&quot;</span><span class="p">)</span>
<span class="n">jwt</span> <span class="o">=</span> <span class="n">Jwt</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">claims</span><span class="p">,</span> <span class="n">jwk</span><span class="p">,</span> <span class="n">alg</span><span class="o">=</span><span class="s2">&quot;ES256&quot;</span><span class="p">,</span> <span class="n">extra_headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;header1&quot;</span><span class="p">:</span> <span class="s2">&quot;value1&quot;</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">jwt</span><span class="p">)</span>
<span class="c1"># eyJoZWFkZXIxIjoidmFsdWUxIiwiYWxnIjoiRVMyNTYifQ.eyJjbGFpbTEiOiJ2YWx1ZTEiLCJjbGFpbTIiOiJ2YWx1ZTIifQ.m0Bi8D6Rdi6HeH4J45JPSaeGPxjboAf_-efQ3mUAi6Gs0ipC0MXg9rd727IIINUsVfU0geUn7IwA1HjoTOsHvg</span>
<span class="nb">print</span><span class="p">(</span><span class="n">jwt</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
<span class="c1"># {&#39;header1&#39;: &#39;value1&#39;, &#39;alg&#39;: &#39;ES256&#39;}</span>
</code></pre></div></td></tr></table></div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/guillp/jwskate" target="_blank" rel="noopener" title="Github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:guill.p.linux@gmail.com" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.indexes", "navigation.tabs", "navigation.instant", "navigation.tabs.sticky"], "search": "../assets/javascripts/workers/search.a264c092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.726fbb30.min.js"></script>
      
    
  </body>
</html>